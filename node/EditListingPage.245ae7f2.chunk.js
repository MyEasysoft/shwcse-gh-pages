"use strict";exports.id=981,exports.ids=[981],exports.modules={6072:(e,t,i)=>{i.r(t),i.d(t,{EditListingPageComponent:()=>di,default:()=>gi});var n=i(6689),a=i.n(n),l=i(6695),s=i(4661),r=i(6022),o=i(1233),c=i(6319),d=i(5161),u=i(3665),g=i(4941),p=i(5863),m=i(6902),E=i(6378),y=i(9930),v=i(2745),b=i(7656),h=i(9003),P=i.n(h),_=i(6639),L=i(6134),k=i(2887),f=i(1422),T=i(5836),D=i(7285),C=i(580),A=i.n(C),S=i(3176);const x=i(9696).Z;const I=i(6464).Z;var N=i(1420),W=i(6718),w=i(6974),F=i(190),M=i(7885),U=i(2411);const H="WeekPicker_root__ZSkPB",Z="WeekPicker_label__OGVee",O="WeekPicker_popup__NYAWJ",R="WeekPicker_isOpen__tf6+k",B=new Date,z=e=>a().createElement(U.Form,Object.assign({},e,{onSubmit:()=>null,render:e=>{const{handleSubmit:t,children:i}=e;return a().createElement(y.l0,{onSubmit:t,tabIndex:"0"},a().createElement("div",null,i))}})),j=e=>t=>{27===t.keyCode&&e(!1)},V=e=>{const[t,i]=(0,n.useState)(!1),[l,s]=(0,n.useState)((0,S.$T)(e.date,e.timeZone)),{rootClassName:r,className:o,label:c,date:d,onDateChange:u,timeZone:g,initialValues:p,...m}=e,E=e=>{s(e)},v=P()(r||H,o),b=P()(O,{[R]:t});return a().createElement(y.jx,{onOutsideClick:()=>i(!1)},a().createElement("div",{className:v,onKeyDown:j(i)},a().createElement(y.T5,{className:Z,onClick:()=>i((e=>!e))},c),a().createElement("div",{className:b},t?a().createElement(z,{initialValues:p},a().createElement(y.zE,Object.assign({name:"dates",minimumNights:6,onChange:e=>{let{startDate:t,endDate:n}=e;u(t),i(!1)},initialVisibleMonth:(0,S.$T)(d,g),onPrevMonthClick:()=>E((0,w.RE)(l,g)),onNextMonthClick:()=>E((0,w._l)(l,g)),navNext:a().createElement(F.Z,{showUntilDate:(0,w.Kg)(g,B),startOfNextRange:(0,w._l)(l,g)}),navPrev:a().createElement(M.Z,{showUntilDate:(0,S.RY)(B,"month",g),startOfPrevRange:(0,w.RE)(l,g)})},m))):null)))},Q={titleWrapper:"WeeklyCalendar_titleWrapper__Fjty2",weekPicker:"WeeklyCalendar_weekPicker__NRv+g marketplaceSearchFilterSublabelFontStyles",sectionTitle:"WeeklyCalendar_sectionTitle__ckdbM marketplaceSearchFilterSublabelFontStyles",weekPickerLabel:"WeeklyCalendar_weekPickerLabel__5WGN8 marketplaceSearchFilterSublabelFontStyles",weekRange:"WeeklyCalendar_weekRange__SAdar",rangePart:"WeeklyCalendar_rangePart__vZ5LK",weekPickerIcon:"WeeklyCalendar_weekPickerIcon__jA3Nb",navigation:"WeeklyCalendar_navigation__v0+aW",button:"WeeklyCalendar_button__hibIs",prev:"WeeklyCalendar_prev__SZqD9 WeeklyCalendar_button__hibIs",next:"WeeklyCalendar_next__8XEcD WeeklyCalendar_button__hibIs",grid:"WeeklyCalendar_grid__WoQVz",dateLabelContainer:"WeeklyCalendar_dateLabelContainer__evegH",dateLabel:"WeeklyCalendar_dateLabel__k8anz p",dateAndMonth:"WeeklyCalendar_dateAndMonth__qTPq8 h5",blockedDateLabel:"WeeklyCalendar_blockedDateLabel__HFN1R",info:"WeeklyCalendar_info__fIcxo",planEntries:"WeeklyCalendar_planEntries__wuVuH",exceptionsContainer:"WeeklyCalendar_exceptionsContainer__KMG06",exceptionsTitle:"WeeklyCalendar_exceptionsTitle__k94Q+ marketplaceSmallFontStyles",exceptionsSubtitle:"WeeklyCalendar_exceptionsSubtitle__UbcJe marketplaceTinyFontStyles",timeRange:"WeeklyCalendar_timeRange__FhSKf marketplaceTinyFontStyles",availabilityDot:"WeeklyCalendar_availabilityDot__BSDar",isAvailable:"WeeklyCalendar_isAvailable__BGcPL",planEntry:"WeeklyCalendar_planEntry__hIYUo",deleteIconWrapper:"WeeklyCalendar_deleteIconWrapper__5w8Q6",deleteIcon:"WeeklyCalendar_deleteIcon__+PI3f",deleteButton:"WeeklyCalendar_deleteButton__izPaD",exception:"WeeklyCalendar_exception__m3UsM",date:"WeeklyCalendar_date__u-E9u marketplaceTabNavHorizontalFontStyles",blockedDate:"WeeklyCalendar_blockedDate__W0RYd"},Y=new Date,G=(e,t,i)=>{const n=(0,S.yy)(e,i);return(0,S.gI)("".concat(n," ").concat(t),i)},q=(e,t,i,n)=>"00:00"!=t||i?G(e,t,n):(0,S.RY)(e,"day",n,1,"days"),X=e=>{let{dateId:t,hasAvailability:i,timeZone:n}=e;const l=(0,S.Cl)(t,n);return a().createElement("div",{className:P()(Q.dateLabelContainer,{[Q.blockedDateLabel]:!i})},a().createElement(y.H4,{className:P()(Q.dateLabel)},a().createElement(o.Ji,{value:l,weekday:"long",timeZone:n}),a().createElement("br",null),a().createElement("span",{className:Q.dateAndMonth},a().createElement(o.Ji,{value:l,month:"long",day:"numeric",timeZone:n}))))},K=e=>{let{date:t,entry:i,useFullDays:n,isDaily:l,timeZone:s,intl:r,...c}=e;const d=i.seats>0?a().createElement(o._H,{id:"EditListingAvailabilityPanel.WeeklyCalendar.available"}):a().createElement(o._H,{id:"EditListingAvailabilityPanel.WeeklyCalendar.notAvailable"});return a().createElement("div",Object.assign({className:Q.planEntry},c),a().createElement("div",{className:P()(Q.availabilityDot,{[Q.isAvailable]:i.seats>0})}),n?d:a().createElement(y.tn,{className:Q.timeRange,startDate:G(t,i.startTime,s),endDate:q(t,i.endTime,l,s),dateType:n?u.FJ:u.E2,timeZone:s}))},J=e=>{let{exception:t,useFullDays:i,isDaily:n,timeZone:l,onDeleteAvailabilityException:s}=e;const r=new Date(t.attributes.end.getTime()-1),o=n?r:t.attributes.end;return a().createElement("div",{className:Q.exception},a().createElement("div",{className:P()(Q.availabilityDot,{[Q.isAvailable]:t.attributes.seats>0})}),a().createElement(y.tn,{className:Q.timeRange,startDate:t.attributes.start,endDate:o,dateType:i?u.FJ:u.E2,timeZone:l}),a().createElement("button",{className:Q.deleteButton,onClick:()=>s({id:t.id})},a().createElement("span",{className:Q.deleteIconWrapper},a().createElement(y.Fz,{rootClassName:Q.deleteIcon}))))},$=e=>{let{availableExceptions:t,useFullDays:i,isDaily:n,timeZone:l,onDeleteAvailabilityException:s}=e;return t.length>0?a().createElement(a().Fragment,null,a().createElement(y.X6,{as:"h6",rootClassName:Q.exceptionsSubtitle},a().createElement(o._H,{id:"EditListingAvailabilityPanel.WeeklyCalendar.available"})),t.map((e=>a().createElement(J,{key:e.id.uuid,exception:e,timeZone:l,useFullDays:i,isDaily:n,onDeleteAvailabilityException:s})))):null},ee=e=>{let{blockingExceptions:t,useFullDays:i,isDaily:n,timeZone:l,onDeleteAvailabilityException:s}=e;return t.length>0?a().createElement(a().Fragment,null,a().createElement(y.X6,{as:"h6",rootClassName:Q.exceptionsSubtitle},a().createElement(o._H,{id:"EditListingAvailabilityPanel.WeeklyCalendar.notAvailable"})),t.map((e=>a().createElement(J,{key:e.id.uuid,exception:e,timeZone:l,useFullDays:i,isDaily:n,onDeleteAvailabilityException:s})))):null},te=e=>{var t,i;const n=(0,o.YB)(),{availabilityData:l,hasAvailability:s,isDaily:r,useFullDays:c,onDeleteAvailabilityException:d,fetchExceptionsInProgress:u,fetchExceptionsError:g,timeZone:p}=e,m=(null===l||void 0===l||null===(t=l.planEntries)||void 0===t?void 0:t.length)>0,E=(null===l||void 0===l||null===(i=l.exceptions)||void 0===i?void 0:i.length)>0,v=l.exceptions.filter((e=>e.attributes.seats>0)),b=l.exceptions.filter((e=>0===e.attributes.seats)),h=(0,S.Cl)(null===l||void 0===l?void 0:l.id,p);return a().createElement("div",{className:P()(Q.date,{[Q.blockedDate]:!s})},a().createElement("div",{className:Q.info},m?a().createElement("div",{className:Q.planEntries},l.planEntries.map(((e,t)=>a().createElement(K,{key:"entry".concat(t),date:h,entry:e,timeZone:p,isDaily:r,useFullDays:c,intl:n})))):null,E||g?a().createElement("div",{className:Q.exceptionsContainer},a().createElement(y.X6,{as:"h5",rootClassName:Q.exceptionsTitle,title:"Exceptions overwrite weekly schedule"},a().createElement(o._H,{id:"EditListingAvailabilityPanel.WeeklyCalendar.exceptions"})),u?a().createElement(y.vM,null):g?a().createElement(o._H,{id:"EditListingAvailabilityPanel.WeeklyCalendar.fetchExceptionsError"}):a().createElement(a().Fragment,null,a().createElement($,{availableExceptions:v,useFullDays:c,isDaily:r,timeZone:p,onDeleteAvailabilityException:d}),a().createElement(ee,{blockingExceptions:b,useFullDays:c,isDaily:r,timeZone:p,onDeleteAvailabilityException:d}))):null))},ie=e=>{let{currentWeek:t,endOfCurrentWeek:i,timeZone:n,intl:l}=e;const s={year:"numeric",month:"short",day:"numeric",timeZone:n},r=l.formatDateTimeRange(t,i,s);return r.length>30?r.split("\u2013").map(((e,t)=>a().createElement("span",{key:"weekspan".concat(t),className:Q.rangePart},e,0==t?" ".concat("\u2013"," "):null))):a().createElement("span",{className:Q.rangePart},r)},ne=e=>{const[t,i]=(0,n.useState)((e=>{let{locationSearch:t,timeZone:i,firstDayOfWeek:n}=e;const a=null!==t&&void 0!==t&&t.d?(0,S.Cl)(t.d,i):new Date;return(0,S.IS)(a,i,n)})({...e,timeZone:e.availabilityPlan.timezone})),l=(0,o.YB)(),{className:s,rootClassName:r,headerClassName:c,listingId:d,availabilityPlan:u,availabilityExceptions:g,weeklyExceptionQueries:p,isDaily:m,useFullDays:E,onDeleteAvailabilityException:v,onFetchExceptions:b,params:h,firstDayOfWeek:_,routeConfiguration:L,history:k}=e,T=u.timezone,D=(0,w.Kg)(T,new Date),C=(0,S.IS)(Y,T,_),A=(0,S.RY)(t,"day",T,6,"days"),x=(0,S.RY)(t,"day",T,7,"days"),I=(0,W.sg)(t,x,u,g),U=(0,S.yy)(t,T),{fetchExceptionsInProgress:H,fetchExceptionsError:Z}=p[U]||{};(0,n.useEffect)((()=>{if(!(0,S.mh)(t,C,D,"day",T)){i(C);const e=(0,f.EW)("EditListingPage",L,h,{});k.replace(e)}}),[t]),(0,n.useEffect)((()=>{if(N.default.dev&&N.default.verbose&&!1===H){const e=(e,t,i,n)=>{const a={hour:"numeric",minute:"numeric",timeZone:n},s=l.formatDate(e,a),r=l.formatDate(t,a),o=i?"\u2705":"\ud83d\udeab";console.log("          ",o,s," - ",r)};console.log("\n\n%cDaily availability ranges:","font-weight: bold;"),Object.keys(I).forEach((t=>{var i,n,a;const s=l.formatDate(null===(i=I[t])||void 0===i||null===(n=i.ranges)||void 0===n||null===(a=n[0])||void 0===a?void 0:a.start,{weekday:"long"});console.log("\n".concat(t," ").concat(s)),I[t].ranges.map((t=>{e(t.start,t.end,t.seats>0,T)}))}))}}),[t,H]);const O=Object.keys(I),R={currentWeek:t,setCurrentWeek:i,weeklyExceptionQueries:p,listingId:d,timeZone:T,onFetchExceptions:b,firstDayOfWeek:_},B=(0,w.QN)(R),z=P()(r||Q.root,s);return a().createElement("section",{className:z},a().createElement("header",{className:c},a().createElement("div",{className:Q.titleWrapper},a().createElement(y.X6,{as:"h2",className:Q.sectionTitle},a().createElement(o._H,{id:"EditListingAvailabilityPanel.WeeklyCalendar.scheduleTitle"})),a().createElement(V,{className:Q.weekPicker,label:a().createElement("div",{className:Q.weekPickerLabel},a().createElement("span",{className:Q.weekRange},a().createElement(ie,{currentWeek:t,endOfCurrentWeek:A,timeZone:T,intl:l})),a().createElement("span",{className:Q.weekPickerIcon},a().createElement(y.JT,{size:"small",direction:"down"}))),initialValues:{dates:{startDate:t,endDate:A}},firstDayOfWeek:_,date:(0,S.XZ)(t),onDateChange:e=>{const t=(0,S.IS)(e,T,_);i(t);const n=(0,f.EW)("EditListingPage",L,h,{d:(0,S.yy)(t)});k.replace(n)},startDateOffset:e=>(0,S.I4)(e,T,_),endDateOffset:e=>(0,S.ux)(e,T,_),onFocusChange:e=>{let{focused:t}=e;return setWeekPickerFocused(t)},isOutsideRange:e=>!(0,S.mh)(e,C,D,"day",T),timeZone:T})),a().createElement("div",{className:Q.navigation},a().createElement(M.Z,{className:Q.prev,onClick:()=>B(w.XD),showUntilDate:C,startOfPrevRange:(0,w.XD)(t,T,_),size:"big"}),a().createElement(F.Z,{className:Q.next,onClick:()=>B(w.PW),showUntilDate:(0,w.Kg)(T,Y),startOfNextRange:(0,w.PW)(t,T,_),size:"big"}))),a().createElement("div",{className:Q.grid},O.reduce(((e,t)=>{const i=I[t],n=i.hasAvailability;return e.push(a().createElement(X,{key:"label_".concat(null===i||void 0===i?void 0:i.id),dateId:null===i||void 0===i?void 0:i.id,hasAvailability:n,timeZone:T})),e.push(a().createElement(te,{key:t,availabilityData:i,hasAvailability:n,onDeleteAvailabilityException:v,isDaily:m,useFullDays:E,timeZone:T,fetchExceptionsInProgress:H,fetchExceptionsError:Z})),e}),[])))};ne.defaultProps={rootClassName:null,className:null,headerClassName:null,locationSearch:null,availabilityExceptions:[],firstDayOfWeek:0};const ae=ne,le="EditListingAvailabilityPanel_root__FcrAt",se="EditListingAvailabilityPanel_sectionHeader__sxUD-",re="EditListingAvailabilityPanel_planInfo__HnaDL",oe="EditListingAvailabilityPanel_section__-LQKz",ce="EditListingAvailabilityPanel_editPlanButton__0Mwhr",de="EditListingAvailabilityPanel_addExceptionButton__HYYI9 h4",ue="EditListingAvailabilityPanel_goToNextTabButton__zu6Z9",ge="EditListingAvailabilityPanel_modalContainer__dlvoN marketplaceModalBaseStyles",pe="EditListingAvailabilityPanel_error__pZEtQ",me=["sun","mon","tue","wed","thu","fri","sat"],Ee=()=>"undefined"!==typeof window?(0,S.f)():"Etc/UTC",ye=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[];return e.reduce(((e,i)=>{const{startTime:n,endTime:a,dayOfWeek:l}=i,s=e[l]||[];return t=t.includes(l)?t:[...t,l],{...e,[l]:[...s,{startTime:n,endTime:"00:00"===a?"24:00":a}],activePlanDays:t}}),{})},ve=e=>me.reduce(((t,i)=>{const n=(e[i]||[]).map((e=>{const{startTime:t,endTime:n}=e;return t&&n?{dayOfWeek:i,seats:1,startTime:t,endTime:"24:00"===n?"00:00":n}:null}));return t.concat(n.filter((e=>!!e)))}),[]),be=e=>{var t;const{className:i,rootClassName:l,params:s,locationSearch:r,listing:c,monthlyExceptionQueries:d,weeklyExceptionQueries:g,allExceptions:p,onAddAvailabilityException:m,onDeleteAvailabilityException:E,disabled:v,ready:b,onFetchExceptions:h,onSubmit:_,onManageDisableScrolling:L,onNextTab:k,submitButtonText:f,updateInProgress:T,errors:C,config:A,routeConfiguration:N,history:W}=e,[w,F]=(0,n.useState)(!1),[M,U]=(0,n.useState)(!1),[H,Z]=(0,n.useState)(null),O=A.localization.firstDayOfWeek,R=P()(l||le,i),B=null===c||void 0===c?void 0:c.attributes,z=null===B||void 0===B||null===(t=B.publicData)||void 0===t?void 0:t.unitType,j=(0,D.j8)(z),V=!(null===B||void 0===B||!B.availabilityPlan),Q=(null===c||void 0===c?void 0:c.id)&&(null===B||void 0===B?void 0:B.state)!==u.WM,Y={type:"availability-plan/time",timezone:Ee(),entries:[]},G=(null===B||void 0===B?void 0:B.availabilityPlan)||Y,q=H||(e=>{const{timezone:t,entries:i}=e||{};return{timezone:t||Ee(),...ye(i)}})(G),X=p;return a().createElement("main",{className:R},a().createElement(y.H3,{as:"h1"},Q?a().createElement(o._H,{id:"EditListingAvailabilityPanel.title",values:{listingTitle:a().createElement(y.tB,{listing:c}),lineBreak:a().createElement("br",null)}}):a().createElement(o._H,{id:"EditListingAvailabilityPanel.createListingTitle",values:{lineBreak:a().createElement("br",null)}})),a().createElement("div",{className:re},V?null:a().createElement("p",null,a().createElement(o._H,{id:"EditListingAvailabilityPanel.availabilityPlanInfo"})),a().createElement(y.T5,{className:ce,onClick:()=>F(!0)},V?a().createElement(o._H,{id:"EditListingAvailabilityPanel.editAvailabilityPlan"}):a().createElement(o._H,{id:"EditListingAvailabilityPanel.setAvailabilityPlan"}))),V?a().createElement(a().Fragment,null,a().createElement(ae,{className:oe,headerClassName:se,listingId:c.id,availabilityPlan:G,availabilityExceptions:X,weeklyExceptionQueries:g,isDaily:z===D.x4,useFullDays:j,onDeleteAvailabilityException:E,onFetchExceptions:h,params:s,locationSearch:r,firstDayOfWeek:O,routeConfiguration:N,history:W}),a().createElement("section",{className:oe},a().createElement(y.T5,{className:de,onClick:()=>U(!0),disabled:v||!V,ready:b},a().createElement(o._H,{id:"EditListingAvailabilityPanel.addException"})))):null,C.showListingsError?a().createElement("p",{className:pe},a().createElement(o._H,{id:"EditListingAvailabilityPanel.showListingFailed"})):null,Q?null:a().createElement(y.zx,{className:ue,onClick:k,disabled:!V},f),L&&w?a().createElement(y.u_,{id:"EditAvailabilityPlan",isOpen:w,onClose:()=>F(!1),onManageDisableScrolling:L,containerClassName:ge,usePortal:!0},a().createElement(x,{formId:"EditListingAvailabilityPlanForm",listingTitle:null===B||void 0===B?void 0:B.title,availabilityPlan:G,weekdays:(K=me,J=O,0===J?K:K.slice(J).concat(K.slice(0,J))),useFullDays:j,onSubmit:e=>(Z(e),_((e=>({availabilityPlan:{type:"availability-plan/time",timezone:e.timezone,entries:ve(e)}}))(e)).then((()=>{F(!1)})).catch((e=>{}))),initialValues:q,inProgress:T,fetchErrors:C})):null,L&&M?a().createElement(y.u_,{id:"EditAvailabilityExceptions",isOpen:M,onClose:()=>U(!1),onManageDisableScrolling:L,containerClassName:ge,usePortal:!0},a().createElement(I,{formId:"EditListingAvailabilityExceptionForm",listingId:c.id,allExceptions:p,monthlyExceptionQueries:d,fetchErrors:C,onFetchExceptions:h,onSubmit:e=>{const{availability:t,exceptionStartTime:i,exceptionEndTime:n,exceptionRange:a}=e,l="available"===t?1:0,s=j?{start:null===a||void 0===a?void 0:a.startDate,end:null===a||void 0===a?void 0:a.endDate}:{start:(0,S.Ft)(i),end:(0,S.Ft)(n)},r={listingId:c.id,seats:l,...s};return m(r).then((()=>{U(!1)})).catch((e=>{}))},timeZone:G.timezone,isDaily:z===D.x4,updateInProgress:T,useFullDays:j})):null);var K,J};be.defaultProps={className:null,rootClassName:null,listing:null,monthlyExceptionQueries:null,weeklyExceptionQueries:null,allExceptions:[]};const he=be,Pe=e=>{const{invalidExistingListingType:t,noListingTypesSet:i,marketplaceName:n}=e;return t?a().createElement("div",null,a().createElement(y.H2,null,a().createElement(o._H,{id:"EditListingDetailsPanel.invalidListingTypeSetTitle"})),a().createElement("p",null,a().createElement(o._H,{id:"EditListingDetailsPanel.invalidListingTypeSetDescription",values:{marketplaceName:n}}))):i?a().createElement("div",null,a().createElement(y.H2,null,a().createElement(o._H,{id:"EditListingDetailsPanel.noListingTypeSetTitle"})),a().createElement("p",null,a().createElement(o._H,{id:"EditListingDetailsPanel.noListingTypeSetDescription"}))):null};var _e=i(9414);const Le="EditListingDetailsPanel_root__n+H4T",ke="EditListingDetailsPanel_form__3jMRF",fe=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{listingType:n,transactionProcessAlias:a,unitType:l}=t;if(n&&a&&l)return{listingType:n,transactionProcessAlias:a,unitType:l};if(1===e.length){const{listingType:t,label:n,transactionType:a}=e[0],{alias:l,unitType:s}=a;return{listingType:t,transactionProcessAlias:l,unitType:s,...i?{label:n||t}:{}}}return{}},Te=(e,t,i,n)=>n.reduce(((n,a)=>{const{key:l,includeForListingTypes:s,scope:r="public",schemaType:o}=a||{},c="".concat("public"===r?"pub_":"priv_").concat(l),d=u.Mj.includes(o),g=r===t,p=null==s||s.includes(i);if(d&&g&&p){const t=e[c]||null;return{...n,[l]:t}}return d&&g&&!p?{...n,[l]:null}:n}),{}),De=(e,t,i,n)=>n.reduce(((n,a)=>{const{key:l,includeForListingTypes:s,scope:r="public",schemaType:o}=a||{},c="".concat("public"===r?"pub_":"priv_").concat(l),d=u.Mj.includes(o),g=r===t,p=null==s||s.includes(i);if(d&&g&&p){const t=e[l]||null;return{...n,[c]:t}}return n}),{}),Ce=e=>{const{className:t,rootClassName:i,listing:n,disabled:l,ready:s,onSubmit:r,onListingTypeChange:c,submitButtonText:d,panelUpdated:g,updateInProgress:p,errors:m,config:E}=e,v=P()(i||Le,t),{publicData:b,state:h}=(null===n||void 0===n?void 0:n.attributes)||{},_=E.listing.listingTypes,L=E.listing.listingFields,{hasExistingListingType:k,existingListingTypeInfo:f}=(e=>{const{listingType:t,transactionProcessAlias:i,unitType:n}=e;return{hasExistingListingType:!!t&&!!i&&!!n,existingListingTypeInfo:{listingType:t,transactionProcessAlias:i,unitType:n}}})(b),T=k&&!!_.find((e=>{var t;const i=e.listingType===f.listingType,n=(null===(t=e.transactionType)||void 0===t?void 0:t.unitType)===f.unitType;return i&&n})),C=((e,t,i,n)=>{var a;const{description:l,title:s,publicData:r,privateData:o}=(null===e||void 0===e||null===(a=e.listing)||void 0===a?void 0:a.attributes)||{},{listingType:c}=r;return{title:s,description:l,...fe(i,t),...De(r,"public",c,n),...De(o,"private",c,n)}})(e,f,_,L),A=0===(null===_||void 0===_?void 0:_.length),S=(null===_||void 0===_?void 0:_.length)>0&&(!k||T),x=(null===n||void 0===n?void 0:n.id)&&h!==u.WM;return a().createElement("div",{className:v},a().createElement(y.H3,{as:"h1"},x?a().createElement(o._H,{id:"EditListingDetailsPanel.title",values:{listingTitle:a().createElement(y.tB,{listing:n}),lineBreak:a().createElement("br",null)}}):a().createElement(o._H,{id:"EditListingDetailsPanel.createListingTitle",values:{lineBreak:a().createElement("br",null)}})),S?a().createElement(_e.Z,{className:ke,initialValues:C,saveActionMsg:d,onSubmit:e=>{const{title:t,description:i,listingType:n,transactionProcessAlias:a,unitType:l,...s}=e,o={title:t.trim(),description:i,publicData:{listingType:n,transactionProcessAlias:a,unitType:l,...Te(s,"public",n,L)},privateData:Te(s,"private",n,L),...(c=a,(0,D.Ll)(c)?{}:{availabilityPlan:{type:"availability-plan/time",timezone:"Etc/UTC",entries:[]}})};var c;r(o)},selectableListingTypes:_.map((e=>fe([e],{},!0))),hasExistingListingType:k,onListingTypeChange:c,listingFieldsConfig:L,marketplaceCurrency:E.currency,disabled:l,ready:s,updated:g,updateInProgress:p,fetchErrors:m,autoFocus:!0}):a().createElement(Pe,{marketplaceName:E.marketplaceName,noListingTypesSet:A,invalidExistingListingType:!T}))};Ce.defaultProps={className:null,rootClassName:null,errors:null,listing:null};const Ae=Ce;var Se=i(7975);const xe="EditListingDeliveryPanel_root__6QYfp",Ie="EditListingDeliveryPanel_form__k7M+0",Ne="EditListingDeliveryPanel_priceCurrencyInvalid__Lt1Hw",{Money:We}=c.types,we=e=>{var t,i,n;const{listing:a,listingTypes:l,marketplaceCurrency:s}=e,{geolocation:r,publicData:o,price:c}=(null===a||void 0===a?void 0:a.attributes)||{},d=null===a||void 0===a||null===(t=a.attributes)||void 0===t||null===(i=t.publicData)||void 0===i?void 0:i.listingType,u=l.find((e=>e.listingType===d)),g=(0,k.vA)(u),p=(0,k.r6)(u),m=g&&p,E=(null===o||void 0===o||null===(n=o.location)||void 0===n?void 0:n.address)&&r,y=(null===o||void 0===o?void 0:o.location)||{},{address:v,building:b}=y,{shippingEnabled:h,pickupEnabled:P,shippingPriceInSubunitsOneItem:_,shippingPriceInSubunitsAdditionalItems:L}=o,f=[];(h||!m&&g)&&f.push("shipping"),(P||!m&&p)&&f.push("pickup");const T=(null===c||void 0===c?void 0:c.currency)||s;return{building:b,location:E?{search:v,selectedPlace:{address:v,origin:r}}:{search:void 0,selectedPlace:void 0},deliveryOptions:f,shippingPriceInSubunitsOneItem:null!=_?new We(_,T):null,shippingPriceInSubunitsAdditionalItems:null!=L?new We(L,T):null}},Fe=e=>{var t,i,l,s;const[r,c]=(0,n.useState)({initialValues:we(e)}),{className:d,rootClassName:g,listing:p,listingTypes:m,marketplaceCurrency:E,disabled:v,ready:b,onSubmit:h,submitButtonText:_,panelUpdated:L,updateInProgress:k,errors:f}=e,T=P()(g||xe,d),D=(null===p||void 0===p?void 0:p.id)&&(null===p||void 0===p?void 0:p.attributes.state)!==u.WM,C=(null===p||void 0===p||null===(t=p.attributes)||void 0===t||null===(i=t.price)||void 0===i?void 0:i.currency)===E,A=null===p||void 0===p||null===(l=p.attributes)||void 0===l||null===(s=l.publicData)||void 0===s?void 0:s.listingType,S=m.find((e=>e.listingType===A)),x=S.stockType===u.p9;return a().createElement("div",{className:T},a().createElement(y.H3,{as:"h1"},D?a().createElement(o._H,{id:"EditListingDeliveryPanel.title",values:{listingTitle:a().createElement(y.tB,{listing:p}),lineBreak:a().createElement("br",null)}}):a().createElement(o._H,{id:"EditListingDeliveryPanel.createListingTitle",values:{lineBreak:a().createElement("br",null)}})),C?a().createElement(Se.Z,{className:Ie,initialValues:r.initialValues,onSubmit:e=>{var t,i;const{building:n="",location:a,shippingPriceInSubunitsOneItem:l,shippingPriceInSubunitsAdditionalItems:s,deliveryOptions:r}=e,o=r.includes("shipping"),d=r.includes("pickup"),u=(null===a||void 0===a||null===(t=a.selectedPlace)||void 0===t?void 0:t.address)||null,g=(null===a||void 0===a||null===(i=a.selectedPlace)||void 0===i?void 0:i.origin)||null,p={geolocation:g,publicData:{pickupEnabled:d,...d&&u?{location:{address:u,building:n}}:{},shippingEnabled:o,...o&&null!=l?{shippingPriceInSubunitsOneItem:l.amount,shippingPriceInSubunitsAdditionalItems:null===s||void 0===s?void 0:s.amount}:{}}};c({initialValues:{building:n,location:{search:u,selectedPlace:{address:u,origin:g}},shippingPriceInSubunitsOneItem:l,shippingPriceInSubunitsAdditionalItems:s,deliveryOptions:r}}),h(p)},listingTypeConfig:S,marketplaceCurrency:E,hasStockInUse:x,saveActionMsg:_,disabled:v,ready:b,updated:L,updateInProgress:k,fetchErrors:f,autoFocus:!0}):a().createElement("div",{className:Ne},a().createElement(o._H,{id:"EditListingPricingPanel.listingPriceCurrencyInvalid"})))};Fe.defaultProps={className:null,rootClassName:null,listing:null};const Me=Fe;var Ue=i(3855);const He="EditListingLocationPanel_root__qnU3d",Ze="EditListingLocationPanel_form__OlMB6",Oe=e=>{var t;const{listing:i}=e,{geolocation:n,publicData:a}=(null===i||void 0===i?void 0:i.attributes)||{},l=(null===a||void 0===a||null===(t=a.location)||void 0===t?void 0:t.address)&&n,s=(null===a||void 0===a?void 0:a.location)||{},{address:r,building:o}=s;return{building:o,location:l?{search:r,selectedPlace:{address:r,origin:n}}:null}},Re=e=>{const[t,i]=(0,n.useState)({initialValues:Oe(e)}),{className:l,rootClassName:s,listing:r,disabled:c,ready:d,onSubmit:g,submitButtonText:p,panelUpdated:m,updateInProgress:E,errors:v}=e,b=P()(s||He,l),h=(null===r||void 0===r?void 0:r.id)&&(null===r||void 0===r?void 0:r.attributes.state)!==u.WM;return a().createElement("div",{className:b},a().createElement(y.H3,{as:"h1"},h?a().createElement(o._H,{id:"EditListingLocationPanel.title",values:{listingTitle:a().createElement(y.tB,{listing:r}),lineBreak:a().createElement("br",null)}}):a().createElement(o._H,{id:"EditListingLocationPanel.createListingTitle",values:{lineBreak:a().createElement("br",null)}})),a().createElement(Ue.Z,{className:Ze,initialValues:t.initialValues,onSubmit:e=>{const{building:t="",location:n}=e,{selectedPlace:{address:a,origin:l}}=n,s={geolocation:l,publicData:{location:{address:a,building:t}}};i({initialValues:{building:t,location:{search:a,selectedPlace:{address:a,origin:l}}}}),g(s)},saveActionMsg:p,disabled:c,ready:d,updated:m,updateInProgress:E,fetchErrors:v,autoFocus:!0}))},{func:Be,object:ze,string:je,bool:Ve}=A();Re.defaultProps={className:null,rootClassName:null,listing:null};const Qe=Re;var Ye=i(1004);const Ge="EditListingPhotosPanel_root__neabH",qe="EditListingPhotosPanel_form__+Kc5b",Xe=e=>{const{images:t}=e;return{images:t}},Ke=e=>{var t;const{className:i,rootClassName:n,errors:l,disabled:s,ready:r,listing:c,onImageUpload:d,submitButtonText:g,panelUpdated:p,updateInProgress:m,onSubmit:E,onRemoveImage:v,listingImageConfig:b}=e,h=n||Ge,_=P()(h,i),L=(null===c||void 0===c?void 0:c.id)&&(null===c||void 0===c||null===(t=c.attributes)||void 0===t?void 0:t.state)!==u.WM;return a().createElement("div",{className:_},a().createElement(y.H3,{as:"h1"},L?a().createElement(o._H,{id:"EditListingPhotosPanel.title",values:{listingTitle:a().createElement(y.tB,{listing:c}),lineBreak:a().createElement("br",null)}}):a().createElement(o._H,{id:"EditListingPhotosPanel.createListingTitle",values:{lineBreak:a().createElement("br",null)}})),a().createElement(Ye.ZP,{className:qe,disabled:s,ready:r,fetchErrors:l,initialValues:Xe(e),onImageUpload:d,onSubmit:e=>{const{addImage:t,...i}=e;E(i)},onRemoveImage:v,saveActionMsg:g,updated:p,updateInProgress:m,listingImageConfig:b}))};Ke.defaultProps={className:null,rootClassName:null,errors:null,images:[],listing:null};const Je=Ke;var $e=i(2448);const et="EditListingPricingPanel_root__Jph8a",tt="EditListingPricingPanel_form__EC0mp",it="EditListingPricingPanel_priceCurrencyInvalid__+5vFI",{Money:nt}=c.types,at=e=>{var t,i,n;const{className:l,rootClassName:s,listing:r,marketplaceCurrency:c,listingMinimumPriceSubUnits:d,disabled:g,ready:p,onSubmit:m,submitButtonText:E,panelUpdated:v,updateInProgress:b,errors:h}=e,_=P()(s||et,l),L=(e=>{const{listing:t}=e,{price:i}=(null===t||void 0===t?void 0:t.attributes)||{};return{price:i}})(e),k=(null===r||void 0===r?void 0:r.id)&&(null===r||void 0===r||null===(t=r.attributes)||void 0===t?void 0:t.state)!==u.WM,f=c&&L.price instanceof nt?L.price.currency===c:!!c,T=null===r||void 0===r||null===(i=r.attributes)||void 0===i||null===(n=i.publicData)||void 0===n?void 0:n.unitType;return a().createElement("div",{className:_},a().createElement(y.H3,{as:"h1"},k?a().createElement(o._H,{id:"EditListingPricingPanel.title",values:{listingTitle:a().createElement(y.tB,{listing:r}),lineBreak:a().createElement("br",null)}}):a().createElement(o._H,{id:"EditListingPricingPanel.createListingTitle",values:{lineBreak:a().createElement("br",null)}})),f?a().createElement($e.Z,{className:tt,initialValues:L,onSubmit:e=>{const{price:t}=e;m({price:t})},marketplaceCurrency:c,unitType:T,listingMinimumPriceSubUnits:d,saveActionMsg:E,disabled:g,ready:p,updated:v,updateInProgress:b,fetchErrors:h}):a().createElement("div",{className:it},a().createElement(o._H,{id:"EditListingPricingPanel.listingPriceCurrencyInvalid",values:{marketplaceCurrency:c}})))},{func:lt,object:st,string:rt,bool:ot}=A();at.defaultProps={className:null,rootClassName:null,listing:null};const ct=at;var dt=i(7335);const ut="EditListingPricingAndStockPanel_root__uNhR5",gt="EditListingPricingAndStockPanel_form__QtEH2",pt="EditListingPricingAndStockPanel_priceCurrencyInvalid__tjzZ1",{Money:mt}=c.types,Et=1e15,yt=(e,t)=>{const i=e.listingType;return t.find((e=>e.listingType===i))},vt=e=>{var t,i,n,a;const{listing:l,listingTypes:s}=e,r=(null===l||void 0===l?void 0:l.id)&&(null===l||void 0===l||null===(t=l.attributes)||void 0===t?void 0:t.state)!==u.WM,o=null===l||void 0===l||null===(i=l.attributes)||void 0===i?void 0:i.price,c=null===l||void 0===l?void 0:l.currentStock,d=null===l||void 0===l||null===(n=l.attributes)||void 0===n?void 0:n.publicData,g=yt(d,s),p=u.Gw.includes(null===g||void 0===g?void 0:g.stockType),m=null===c||void 0===c||null===(a=c.attributes)||void 0===a?void 0:a.quantity;return{price:o,stock:null!=m?m:r?0:p?Et:1,stockTypeInfinity:[]}},bt=e=>{var t,i,l;const[s,r]=(0,n.useState)({initialValues:vt(e)}),{className:c,rootClassName:d,listing:g,marketplaceCurrency:p,listingMinimumPriceSubUnits:m,listingTypes:E,disabled:v,ready:b,onSubmit:h,submitButtonText:_,panelUpdated:L,updateInProgress:k,errors:f}=e,T=P()(d||ut,c),D=s.initialValues,C=null===g||void 0===g||null===(t=g.attributes)||void 0===t?void 0:t.publicData,A=C.unitType,S=yt(C,E),x=u.Gw.includes(null===S||void 0===S?void 0:S.stockType),I=(null===g||void 0===g?void 0:g.id)&&(null===g||void 0===g||null===(i=g.attributes)||void 0===i?void 0:i.state)!==u.WM,N=p&&D.price instanceof mt?(null===(l=D.price)||void 0===l?void 0:l.currency)===p:!!p;return a().createElement("div",{className:T},a().createElement(y.H3,{as:"h1"},I?a().createElement(o._H,{id:"EditListingPricingAndStockPanel.title",values:{listingTitle:a().createElement(y.tB,{listing:g}),lineBreak:a().createElement("br",null)}}):a().createElement(o._H,{id:"EditListingPricingAndStockPanel.createListingTitle",values:{lineBreak:a().createElement("br",null)}})),N?a().createElement(dt.Z,{className:gt,initialValues:D,onSubmit:e=>{var t,i,n;const{price:a,stock:l,stockTypeInfinity:s}=e,o="infinity"===(null===s||void 0===s?void 0:s[0]),c=null==(null===g||void 0===g||null===(t=g.currentStock)||void 0===t||null===(i=t.attributes)||void 0===i?void 0:i.quantity),d=l&&l!==D.stock,u=c?null:D.stock,p=x&&(c||o)?{stockUpdate:{oldTotal:u,newTotal:Et}}:c||d?{stockUpdate:{oldTotal:u,newTotal:l}}:{},m={price:a,...p};r({initialValues:{price:a,stock:(null===p||void 0===p||null===(n=p.stockUpdate)||void 0===n?void 0:n.newTotal)||l,stockTypeInfinity:s}}),h(m)},listingMinimumPriceSubUnits:m,marketplaceCurrency:p,listingType:S,unitType:A,saveActionMsg:_,disabled:v,ready:b,updated:L,updateInProgress:k,fetchErrors:f}):a().createElement("div",{className:pt},a().createElement(o._H,{id:"EditListingPricingAndStockPanel.listingPriceCurrencyInvalid",values:{marketplaceCurrency:p}})))},{func:ht,object:Pt,string:_t,bool:Lt}=A();bt.defaultProps={className:null,rootClassName:null,listing:null};const kt=bt,ft="EditListingWizardTab_panel__91kEt",Tt="details",Dt="pricing",Ct="pricing-and-stock",At="delivery",St="location",xt="availability",It="photos",Nt=(e,t,i,n,a,l)=>{const s=e.uuid,r={...t,type:d.Ms,id:s};if(t.type===d.wS){const e=(0,f.EW)("EditListingPage",l,r,{});a.replace(e)}const o=((e,t,i)=>{const n=i.findIndex((e=>e===t))+1;return{...e,tab:n<i.length?i[n]:i[i.length-1]}})(r,i,n),c=(0,f.EW)("EditListingPage",l,o,{});a.push(c)},Wt=e=>{const{tab:t,marketplaceTabs:i,params:n,locationSearch:l,errors:s,fetchInProgress:r,newListingPublished:o,handleCreateFlowTabScrolling:c,handlePublishListing:u,history:p,images:m,listing:E,weeklyExceptionQueries:y,monthlyExceptionQueries:v,allExceptions:b,onFetchExceptions:h,onAddAvailabilityException:P,onDeleteAvailabilityException:_,onUpdateListing:L,onCreateListingDraft:k,onImageUpload:f,onManageDisableScrolling:T,onListingTypeChange:D,onRemoveImage:C,updatedTab:A,updateInProgress:S,tabSubmitButtonText:x,config:I,routeConfiguration:N}=e,{type:W}=n,w=W===d.wS,F=W===d.Ms,M=w||F,U=(0,g.Me)(E),H=(e,t)=>{const a=w?(e,t)=>k(t,I):(e,t)=>L(e,t,I),l=w?t:{...t,id:U.id};return a(e,l).then((t=>{if(M&&e!==xt){const a=t.data.data.id;((e,t)=>{e!==i[i.length-1]?(c(!1),Nt(t,n,e,i,p,N)):u(t)})(e,a)}})).catch((e=>{}))},Z=e=>({className:ft,errors:s,listing:E,panelUpdated:A===e,params:n,locationSearch:l,updateInProgress:S,ready:o,disabled:r,submitButtonText:x,listingTypes:I.listing.listingTypes,onManageDisableScrolling:T,onSubmit:t=>H(e,t)});switch(t){case Tt:return a().createElement(Ae,Object.assign({},Z(Tt),{onListingTypeChange:D,config:I}));case Ct:return a().createElement(kt,Object.assign({},Z(Ct),{marketplaceCurrency:I.currency,listingMinimumPriceSubUnits:I.listingMinimumPriceSubUnits}));case Dt:return a().createElement(ct,Object.assign({},Z(Dt),{marketplaceCurrency:I.currency,listingMinimumPriceSubUnits:I.listingMinimumPriceSubUnits}));case At:return a().createElement(Me,Object.assign({},Z(At),{marketplaceCurrency:I.currency}));case St:return a().createElement(Qe,Z(St));case xt:return a().createElement(he,Object.assign({allExceptions:b,weeklyExceptionQueries:y,monthlyExceptionQueries:v,onFetchExceptions:h,onAddAvailabilityException:P,onDeleteAvailabilityException:_,onNextTab:()=>Nt(E.id,n,t,i,p,N),config:I,history:p,routeConfiguration:N},Z(xt)));case It:return a().createElement(Je,Object.assign({},Z(It),{listingImageConfig:I.layout.listingImage,images:m,onImageUpload:f,onRemoveImage:C}));default:return null}};Wt.defaultProps={listing:null,updatedTab:null};const{array:wt,bool:Ft,func:Mt,object:Ut,oneOf:Ht,shape:Zt,string:Ot}=A(),Rt=Wt;var Bt=i(5250);const zt=[Tt],jt=[Tt,Ct,At,It],Vt=[Tt,St,Dt,xt,It],Qt=[Tt,St,Dt,It],Yt="success",Gt="failure",qt=(e,t)=>t.length>0?e.filter((e=>!t.includes(e))):e,Xt=(e,t,i)=>{const n=(t,i)=>{const{key:n,includeForListingTypes:a,schemaType:l,enumOptions:s=[],saveConfig:r={}}=t,o=s.map((e=>"".concat(e.option)));if(!!r.isRequired&&(null==a||a.includes(null===e||void 0===e?void 0:e.listingType))){const e=i[n];return l===u.wR?"string"===typeof e&&(c=e,o.includes(c)):l===u.KP?Array.isArray(e)&&e.every((e=>o.includes(e))):l===u.d$?"string"===typeof e:l===u.F5?"number"===typeof e&&Number.isInteger(e):l===u.WW&&(!0===e||!1===e)}var c;return!0};return i.listing.listingFields.reduce(((i,a)=>{const l="private"===a.scope?t:e;return i&&n(a,l)}),!0)},Kt=(e,t,i,n)=>i.reduce(((a,l)=>{var s,r;const o=i.findIndex((e=>e===l))-1,c=o>=0,d=!(null===t||void 0===t||null===(s=t.attributes)||void 0===s||null===(r=s.publicData)||void 0===r||!r.listingType),u=((e,t,i)=>{var n;const{availabilityPlan:a,description:l,geolocation:s,price:r,title:o,publicData:c,privateData:d}=t.attributes,u=t.images,{listingType:g,transactionProcessAlias:p,unitType:m,shippingEnabled:E,pickupEnabled:y}=c||{},v=c&&(E||y);switch(e){case Tt:return!!(l&&o&&g&&p&&m&&Xt(c,d,i));case Dt:case Ct:return!!r;case At:return!!v;case St:return!(!s||null===c||void 0===c||null===(n=c.location)||void 0===n||!n.address);case xt:return!!a;case It:return u&&u.length>0;default:return!1}})(i[o],t,n);return{...a,[l]:c&&!e?d:!c||!e||u}}),{}),Jt=(e,t,i,n)=>{const a=(0,f.EW)("EditListingStripeOnboardingPage",i,{...n,returnURLType:e},{}),l=t.replace(/\/$/,"");return"".concat(l).concat(a)},$t=e=>e.attributes.stripeAccountData||null,ei=e=>e&&e.external_accounts.data.length>0?e.external_accounts.data[0].last4:null,ti=(e,t)=>null!=e&&e.requirements&&Array.isArray(e.requirements[t])&&e.requirements[t].length>0,ii=e=>{let{redirectFn:t}=e;return(0,n.useEffect)(t("custom_account_verification"),[]),a().createElement(o._H,{id:"EditListingWizard.redirectingToStripe"})},ni=(e,t,i)=>{var n,a;const l=null===e||void 0===e||null===(n=e.attributes)||void 0===n||null===(a=n.publicData)||void 0===a?void 0:a.listingType,s=i.listing.listingTypes,r=1===(null===s||void 0===s?void 0:s.length);return l?s.find((e=>e.listingType===l)):t?s.find((e=>e.listingType===t.listingType)):r?s[0]:null};class ai extends n.Component{constructor(e){super(e),this.hasScrolledToTab=!1,this.state={draftId:null,showPayoutDetails:!1,selectedListingType:null},this.handleCreateFlowTabScrolling=this.handleCreateFlowTabScrolling.bind(this),this.handlePublishListing=this.handlePublishListing.bind(this),this.handlePayoutModalClose=this.handlePayoutModalClose.bind(this)}componentDidMount(){const{stripeOnboardingReturnURL:e}=this.props;null==e||this.showPayoutDetails||this.setState({showPayoutDetails:!0})}handleCreateFlowTabScrolling(e){this.hasScrolledToTab=e}handlePublishListing(e){var t,i,n;const{onPublishListingDraft:a,currentUser:l,stripeAccount:s,listing:r,config:o}=this.props,c=(null===r||void 0===r||null===(t=r.attributes)||void 0===t||null===(i=t.publicData)||void 0===i?void 0:i.transactionProcessAlias.split("/")[0])===D.N5,d=ni(r,this.state.selectedListingType,o),u=(0,k.jP)(d),g=!(null===l||void 0===l||null===(n=l.stripeAccount)||void 0===n||!n.id),p=g?$t(s):null,m=s&&(ti(p,"past_due")||ti(p,"currently_due"));c||!u||g&&!m?a(e):this.setState({draftId:e,showPayoutDetails:!0})}handlePayoutModalClose(){this.setState({showPayoutDetails:!1})}render(){var e,t,i,n,l;const{id:s,className:r,rootClassName:c,params:u,listing:p,viewport:m,intl:E,errors:v,fetchInProgress:b,payoutDetailsSaveInProgress:h,payoutDetailsSaved:_,onManageDisableScrolling:L,onPayoutDetailsChange:f,onGetStripeConnectAccountLink:T,getAccountLinkInProgress:C,createStripeAccountError:A,updateStripeAccountError:S,fetchStripeAccountError:x,stripeAccountFetched:I,stripeAccount:N,stripeAccountError:W,stripeAccountLinkError:w,currentUser:F,config:M,routeConfiguration:U,...H}=this.props,Z=u.tab,O=[d.wS,d.Ms].includes(u.type),R=c||Bt.Z.root,B=P()(R,r),z=(0,g.Me)(p),j=(null===(e=z.attributes)||void 0===e||null===(t=e.publicData)||void 0===t?void 0:t.transactionProcessAlias)||(null===(i=this.state.selectedListingType)||void 0===i?void 0:i.transactionProcessAlias),V=M.listing.listingTypes,Q=ni(z,this.state.selectedListingType,M),Y=null===(n=z.attributes)||void 0===n||null===(l=n.publicData)||void 0===l?void 0:l.listingType,G=Y&&!Q,q=!(0,k.ED)(Q),X=j?j.split("/")[0]:1===V.length?V[0].transactionType.process:D.N5,K=Y||this.state.selectedListingType||1===V.length,J=!O||!G&&K?(0,D.YL)(X)?((e,t)=>{const i=(0,k.FD)(t)?[]:[St];return qt(e,i)})(Vt,Q):(0,D.Oe)(X)?((e,t)=>{const i=!(0,k.r6)(t)&&!(0,k.vA)(t);return qt(e,i?[At]:[])})(jt,Q):((e,t)=>{const i=(0,k.FD)(t)?[]:[St],n=(0,k.ED)(t)?[]:[Dt];return qt(e,[...i,...n])})(Qt,Q):zt,$=Kt(O,z,J,M);if(G&&O&&Z!==J[0])return a().createElement(y.d9,{name:"EditListingPage",params:{...u,tab:J[0]}});if(!G&&!$[Z]){const e=J.indexOf(Z),t=J.slice(0,e).reverse().find((e=>$[e]));return console.log("You tried to access an EditListingWizard tab (".concat(Z,"), which was not yet activated.")),a().createElement(y.d9,{name:"EditListingPage",params:{...u,tab:t}})}const{width:ee}=m,te=ee>0,ie=te&&ee<=1023;if(te&&ee>1023)this.hasScrolledToTab=!0;else if(ie&&!this.hasScrolledToTab){((e,t)=>{const i=document.querySelector("#".concat(e,"_").concat(t));i&&i.scrollIntoView({block:"start",behavior:"smooth"})})(s,Z),this.hasScrolledToTab=!0}const ne=e=>({name:"EditListingPage",params:{...u,tab:e}}),ae=C,le=(0,g.j0)(F),se=!!le.id,re=se&&!!N&&!!N.id,oe=M.marketplaceRootURL,{returnURLType:ce,...de}=u,ue=Jt(Yt,oe,U,de),ge=Jt(Gt,oe,U,de),pe=re?N.id:null,me=re?$t(N):null,Ee=N&&(ti(me,"past_due")||ti(me,"currently_due")),ye=me?me.country:null,ve=(be=T,he={accountId:pe,successURL:ue,failureURL:ge},e=>()=>{be({type:e,...he}).then((e=>{window.location.href=e})).catch((e=>console.error(e)))});var be,he;const Pe=ce===Gt,_e=re&&Ee;return ce===Yt&&re&&!Ee?a().createElement(y.d9,{name:"EditListingPage",params:de}):a().createElement("div",{className:B},a().createElement(y.mQ,{rootClassName:Bt.Z.tabsContainer,navRootClassName:Bt.Z.nav,tabRootClassName:Bt.Z.tab},J.map((e=>{const t=((e,t,i,n,a)=>{const l=i?"".concat(a,"."):"",s=i?"new":"edit";let r=null,o=null;return t===Tt?(r="EditListingWizard.tabLabelDetails",o="EditListingWizard.".concat(l).concat(s,".saveDetails")):t===Dt?(r="EditListingWizard.tabLabelPricing",o="EditListingWizard.".concat(l).concat(s,".savePricing")):t===Ct?(r="EditListingWizard.tabLabelPricingAndStock",o="EditListingWizard.".concat(l).concat(s,".savePricingAndStock")):t===At?(r="EditListingWizard.tabLabelDelivery",o="EditListingWizard.".concat(l).concat(s,".saveDelivery")):t===St?(r="EditListingWizard.tabLabelLocation",o=n&&i?"EditListingWizard.".concat(l).concat(s,".saveLocationNoPricingTab"):"EditListingWizard.".concat(l).concat(s,".saveLocation")):t===xt?(r="EditListingWizard.tabLabelAvailability",o="EditListingWizard.".concat(l).concat(s,".saveAvailability")):t===It&&(r="EditListingWizard.tabLabelPhotos",o="EditListingWizard.".concat(l).concat(s,".savePhotos")),{label:e.formatMessage({id:r}),submitButton:e.formatMessage({id:o})}})(E,e,O,q,X);return a().createElement(Rt,Object.assign({},H,{key:e,tabId:"".concat(s,"_").concat(e),tabLabel:t.label,tabSubmitButtonText:t.submitButton,tabLinkProps:ne(e),selected:Z===e,disabled:O&&!$[e],tab:e,params:u,listing:p,marketplaceTabs:J,errors:v,handleCreateFlowTabScrolling:this.handleCreateFlowTabScrolling,handlePublishListing:this.handlePublishListing,fetchInProgress:b,onListingTypeChange:e=>this.setState({selectedListingType:e}),onManageDisableScrolling:L,config:M,routeConfiguration:U}))}))),a().createElement(y.u_,{id:"EditListingWizard.payoutModal",isOpen:this.state.showPayoutDetails,onClose:this.handlePayoutModalClose,onManageDisableScrolling:L,usePortal:!0},a().createElement("div",{className:Bt.Z.modalPayoutDetailsWrapper},a().createElement(y.X6,{as:"h2",rootClassName:Bt.Z.modalTitle},a().createElement(o._H,{id:"EditListingWizard.payoutModalTitleOneMoreThing"}),a().createElement("br",null),a().createElement(o._H,{id:"EditListingWizard.payoutModalTitlePayoutPreferences"})),se?Pe&&!w?a().createElement("p",{className:Bt.Z.modalMessage},a().createElement(ii,{redirectFn:ve})):a().createElement(a().Fragment,null,a().createElement("p",{className:Bt.Z.modalMessage},a().createElement(o._H,{id:"EditListingWizard.payoutModalInfo"})),a().createElement(y.qW,{disabled:ae,inProgress:h,ready:_,currentUser:le,stripeBankAccountLastDigits:ei(me),savedCountry:ye,submitButtonText:E.formatMessage({id:"StripePayoutPage.submitButtonText"}),stripeAccountError:W,stripeAccountFetched:I,stripeAccountLinkError:w,onChange:f,onSubmit:H.onPayoutDetailsSubmit,onGetStripeConnectAccountLink:ve,stripeConnected:re},re&&!Pe&&_e?a().createElement(y.oy,{type:"verificationNeeded",inProgress:C,onGetStripeConnectAccountLink:ve("custom_account_verification")}):re&&ye&&!Pe?a().createElement(y.oy,{type:"verificationSuccess",inProgress:C,disabled:h,onGetStripeConnectAccountLink:ve("custom_account_update")}):null)):a().createElement(o._H,{id:"StripePayoutPage.loadingData"}))))}}ai.defaultProps={className:null,currentUser:null,rootClassName:null,listing:null,stripeAccount:null,stripeAccountFetched:null,updateInProgress:!1,createStripeAccountError:null,updateStripeAccountError:null,fetchStripeAccountError:null,stripeAccountError:null,stripeAccountLinkError:null};const li=(0,T.ss)((e=>{const t=(0,_.mX)(),i=(0,L.a5)(),n=(0,o.YB)();return a().createElement(ai,Object.assign({config:t,routeConfiguration:i,intl:n},e))})),si="EditListingPage_mobileTopbar__SbAP0",ri="EditListingPage_desktopTopbar__Zii9i",oi="EditListingPage_wizard__t2Smb",{UUID:ci}=c.types,di=e=>{const{currentUser:t,createStripeAccountError:i,fetchInProgress:n,fetchStripeAccountError:l,getOwnListing:s,getAccountLinkError:r,getAccountLinkInProgress:o,history:c,intl:p,onFetchExceptions:m,onAddAvailabilityException:E,onDeleteAvailabilityException:b,onCreateListingDraft:h,onPublishListingDraft:P,onUpdateListing:_,onImageUpload:L,onRemoveListingImage:k,onManageDisableScrolling:f,onPayoutDetailsSubmit:T,onPayoutDetailsChange:D,onGetStripeConnectAccountLink:C,page:A,params:S,location:x,scrollingDisabled:I,stripeAccountFetched:N,stripeAccount:W,updateStripeAccountError:w}=e,{id:F,type:M,returnURLType:U}=S,H=M===d.wS,Z=M===d.Ms,O=H||Z,R=A.submittedListingId||(F?new ci(F):null),B=(0,g.YC)(s(R)),{state:z}=B.attributes,j=z&&z!==u.WM,V=O&&R&&j,Q=(!U||!(!t||!t.id))&&(H||B.id);if(V){const e=B&&z===u.v7,t=B?(0,d.qi)(B.attributes.title):null,i=e?{name:"ListingPageVariant",params:{id:R.uuid,slug:t,variant:d.l4}}:{name:"ListingPage",params:{id:R.uuid,slug:t}};return a().createElement(y.d9,i)}if(Q){const{createListingDraftError:e=null,publishListingError:s=null,updateListingError:g=null,showListingsError:F=null,uploadImageError:M=null,setStockError:U=null,uploadedImages:H,uploadedImagesOrder:R,removedImageIds:j,addExceptionError:V=null,deleteExceptionError:Q=null}=A,Y={createListingDraftError:e,publishListingError:s,updateListingError:g,showListingsError:F,uploadImageError:M,setStockError:U,createStripeAccountError:i,addExceptionError:V,deleteExceptionError:Q},G=Z&&B&&z!==u.WM,q=A.redirectToListing&&!F,X=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const a=e&&e.images?e.images:[],l=i.map((e=>t[e])),s=a.concat(l),r=(e,t)=>{const i=t.imageId||t.id;return!e.imageIds.includes(i)&&!n.includes(i)&&(e.imageEntities.push(t),e.imageIds.push(i)),e};return s.reduce(r,{imageEntities:[],imageIds:[]}).imageEntities}(B,H,R,j),K=O?p.formatMessage({id:"EditListingPage.titleCreateListing"}):p.formatMessage({id:"EditListingPage.titleEditListing"});return a().createElement(y.T3,{title:K,scrollingDisabled:I},a().createElement(v.Z,{mobileRootClassName:si,desktopClassName:ri,mobileClassName:si}),a().createElement(li,{id:"EditListingWizard",className:oi,params:S,locationSearch:(0,d.Qc)(x.search),disabled:q,errors:Y,fetchInProgress:n,newListingPublished:G,history:c,images:X,listing:B,weeklyExceptionQueries:A.weeklyExceptionQueries,monthlyExceptionQueries:A.monthlyExceptionQueries,allExceptions:A.allExceptions,onFetchExceptions:m,onAddAvailabilityException:E,onDeleteAvailabilityException:b,onUpdateListing:_,onCreateListingDraft:h,onPublishListingDraft:P,onPayoutDetailsChange:D,onPayoutDetailsSubmit:T,onGetStripeConnectAccountLink:C,getAccountLinkInProgress:o,onImageUpload:L,onRemoveImage:k,currentUser:t,onManageDisableScrolling:f,stripeOnboardingReturnURL:S.returnURLType,updatedTab:A.updatedTab,updateInProgress:A.updateInProgress||A.createListingDraftInProgress,payoutDetailsSaveInProgress:A.payoutDetailsSaveInProgress,payoutDetailsSaved:A.payoutDetailsSaved,stripeAccountFetched:N,stripeAccount:W,stripeAccountError:i||w||l,stripeAccountLinkError:r}))}{const e={id:"EditListingPage.loadingListingData"};return a().createElement(y.T3,{title:p.formatMessage(e),scrollingDisabled:I},a().createElement(v.Z,{mobileRootClassName:si,desktopClassName:ri,mobileClassName:si}))}};di.defaultProps={createStripeAccountError:null,fetchStripeAccountError:null,getAccountLinkError:null,getAccountLinkInProgress:null,stripeAccountFetched:null,currentUser:null,stripeAccount:null,currentUserHasOrders:null,listing:null,listingDraft:null,notificationCount:0,sendVerificationEmailError:null};const ui=(0,l.compose)(s.withRouter,(0,r.connect)((e=>{const t=e.EditListingPage,{getAccountLinkInProgress:i,getAccountLinkError:n,createStripeAccountInProgress:a,createStripeAccountError:l,updateStripeAccountError:s,fetchStripeAccountError:r,stripeAccount:o,stripeAccountFetched:c}=e.stripeConnectAccount;return{getAccountLinkInProgress:i,getAccountLinkError:n,createStripeAccountError:l,updateStripeAccountError:s,fetchStripeAccountError:r,stripeAccount:o,stripeAccountFetched:c,currentUser:e.user.currentUser,fetchInProgress:a,getOwnListing:t=>{const i=(0,p.EV)(e,[{id:t,type:"ownListing"}]);return 1===i.length?i[0]:null},page:t,scrollingDisabled:(0,m.uS)(e)}}),(e=>({onFetchExceptions:t=>e((0,b.dX)(t)),onAddAvailabilityException:t=>e((0,b.g0)(t)),onDeleteAvailabilityException:t=>e((0,b.oG)(t)),onUpdateListing:(t,i,n)=>e((0,b.pI)(t,i,n)),onCreateListingDraft:(t,i)=>e((0,b.Tr)(t,i)),onPublishListingDraft:t=>e((0,b.oE)(t)),onImageUpload:(t,i)=>e((0,b.FS)(t,i)),onManageDisableScrolling:(t,i)=>e((0,m.R4)(t,i)),onPayoutDetailsChange:()=>e((0,E.FZ)()),onPayoutDetailsSubmit:(t,i)=>e((0,b.ZK)(t,i)),onGetStripeConnectAccountLink:t=>e((0,E.cU)(t)),onRemoveListingImage:t=>e((0,b.G$)(t))}))),o.XN)(di),gi=ui}};
//# sourceMappingURL=EditListingPage.245ae7f2.chunk.js.map