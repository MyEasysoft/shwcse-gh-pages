"use strict";exports.id=534,exports.ids=[534],exports.modules={909:(e,t,s)=>{s.r(t),s.d(t,{SearchPageComponent:()=>H,default:()=>L});var r=s(6689),a=s.n(r),i=s(6022),n=s(6695),l=s(4661),o=s(3901),c=s.n(o),d=s(9003),u=s.n(d),h=s(1233),g=s(6639),m=s(6134),p=s(1422),y=s(1956),P=s(5161),b=(s(3665),s(5863)),M=s(6902),C=s(9930),E=s(2745),S=s(7600),f=s(7419),v=s(9733),F=s(5678),Z=s(5876),A=s(7803),k=s(5391),I=s(8351),N=s(8681);class H extends r.Component{constructor(e){super(e),this.state={isMobileModalOpen:!1,currentQueryParams:(0,f.K3)(e)},this.onOpenMobileModal=this.onOpenMobileModal.bind(this),this.onCloseMobileModal=this.onCloseMobileModal.bind(this),this.resetAll=this.resetAll.bind(this),this.getHandleChangedValueFn=this.getHandleChangedValueFn.bind(this),this.handleSortBy=this.handleSortBy.bind(this)}onOpenMobileModal(){this.setState({isMobileModalOpen:!0})}onCloseMobileModal(){this.setState({isMobileModalOpen:!1})}resetAll(e){const{history:t,routeConfiguration:s,config:r}=this.props,{listingFields:a}=(null===r||void 0===r?void 0:r.listing)||{},{defaultFilters:i}=(null===r||void 0===r?void 0:r.search)||{},n=(0,f.K3)(this.props),l=(0,y.sU)(a,i);this.setState({currentQueryParams:{}});const o=c()(n,l);t.push((0,p.EW)("SearchPage",s,{},o))}getHandleChangedValueFn(e){const{history:t,routeConfiguration:s,config:r}=this.props,{listingFields:a}=(null===r||void 0===r?void 0:r.listing)||{},{defaultFilters:i,sortConfig:n}=(null===r||void 0===r?void 0:r.search)||{},l=(0,f.K3)(this.props);return o=>{this.setState((e=>{const{address:t,bounds:s,keywords:a}=l,i={...l,...e.currentQueryParams},n=(0,y.Sy)(r)?{keywords:a}:{};return{currentQueryParams:{...i,...o,...n,address:t,bounds:s}}}),(()=>{if(e){const e=this.state.currentQueryParams,r=(0,f.zU)(e,a,i,n);t.push((0,p.EW)("SearchPage",s,{},r))}}))}}handleSortBy(e,t){const{history:s,routeConfiguration:r}=this.props,a=(0,f.K3)(this.props),i=t?{...a,[e]:t}:c()(a,e);s.push((0,p.EW)("SearchPage",r,{},i))}handleResetAll(e){this.resetAll(e),e&&e.currentTarget&&e.currentTarget.blur()}render(){var e;const{intl:t,listings:s,location:r,onManageDisableScrolling:i,pagination:n,scrollingDisabled:l,searchInProgress:o,searchListingsError:c,searchParams:d,routeConfiguration:g,config:m}=this.props,{listingFields:p}=(null===m||void 0===m?void 0:m.listing)||{},{defaultFilters:b,sortConfig:M}=(null===m||void 0===m?void 0:m.search)||{},H=null===m||void 0===m||null===(e=m.listing)||void 0===e?void 0:e.listingTypes.map((e=>e.listingType)),L=m.currency,{searchParamsAreInSync:Q,urlQueryParams:B,searchParamsInURL:O}=(0,f.uG)(r.search,d,p,b,M,(0,y.QS)(m)),V=(0,f.ZB)(O,p,b,!1),w=(0,y.Sy)(m),D=w?b.filter((e=>"keywords"!==e.key)):b,[R,W]=(0,f.Wo)(p,H),x=[...R,...D,...W],T=(0,f.ZB)(V,p,b),U=null==O.dates||null!=O.dates&&O.dates===T.dates,K=Object.keys(T),_=w?K.filter((e=>"keywords"!==e)).length:K.length,j=!!n&&null!=n.totalItems,G=Q&&j?n.totalItems:null!==n&&void 0!==n&&n.paginationUnsupported?s.length:0,q=!o&&Q&&!!(j||null!==n&&void 0!==n&&n.paginationUnsupported),z=(0,y._)(M.conflictingFilters,V,p,b),X=e=>{var t;return M.active?a().createElement(A.Z,{sort:V[M.queryParamName],isConflictingFilterActive:!!z,hasConflictingFilters:!!((null===(t=M.conflictingFilters)||void 0===t?void 0:t.length)>0),selectedFilters:T,onSelect:this.handleSortBy,showAsPopup:!0,mode:e,contentPlacementOffset:-14}):null},Y=a().createElement(I.Z,{listingsAreLoaded:q,totalItems:G,location:r,resetAll:this.resetAll}),{title:J,description:$,schema:ee}=(0,f.A6)(s,O||{},t,g,m),te=this.state.isMobileModalOpen?u()(N.Z.topbarBehindModal,N.Z.topbar):N.Z.topbar;return a().createElement(C.T3,{scrollingDisabled:l,description:$,title:J,schema:ee},a().createElement(E.Z,{rootClassName:te,currentPage:"SearchPage",currentSearchParams:B}),a().createElement("div",{className:N.Z.layoutWrapperContainer},a().createElement("aside",{className:N.Z.layoutWrapperFilterColumn,"data-testid":"filterColumnAside"},a().createElement("div",{className:N.Z.filterColumnContent},x.map((e=>a().createElement(v.Z,{key:"SearchFiltersMobile.".concat(e.scope||"built-in",".").concat(e.key),idPrefix:"SearchFiltersMobile",className:N.Z.filter,config:e,marketplaceCurrency:L,urlQueryParams:B,initialValues:(0,f.Sc)(this.props,this.state.currentQueryParams),getHandleChangedValueFn:this.getHandleChangedValueFn,intl:t,liveEdit:!0,showAsPopup:!1,isDesktop:!0}))),a().createElement("button",{className:N.Z.resetAllButton,onClick:e=>this.handleResetAll(e)},a().createElement(h._H,{id:"SearchFiltersMobile.resetAll"})))),a().createElement("div",{className:N.Z.layoutWrapperMain,role:"main"},a().createElement("div",{className:N.Z.searchResultContainer},a().createElement(Z.Z,{className:N.Z.searchFiltersMobileList,urlQueryParams:V,sortByComponent:X("mobile"),listingsAreLoaded:q,resultsCount:G,searchInProgress:o,searchListingsError:c,showAsModalMaxWidth:768,onManageDisableScrolling:i,onOpenModal:this.onOpenMobileModal,onCloseModal:this.onCloseMobileModal,resetAll:this.resetAll,selectedFiltersCount:_,isMapVariant:!1,noResultsInfo:Y},x.map((e=>a().createElement(v.Z,{key:"SearchFiltersMobile.".concat(e.scope||"built-in",".").concat(e.key),idPrefix:"SearchFiltersMobile",config:e,marketplaceCurrency:L,urlQueryParams:V,initialValues:(0,f.Sc)(this.props,this.state.currentQueryParams),getHandleChangedValueFn:this.getHandleChangedValueFn,intl:t,liveEdit:!0,showAsPopup:!1})))),a().createElement(F.Z,{className:N.Z.mainPanel,sortByComponent:X("desktop"),isSortByActive:M.active,listingsAreLoaded:q,resultsCount:G,searchInProgress:o,searchListingsError:c,noResultsInfo:Y}),a().createElement("div",{className:u()(N.Z.listingsForGridVariant,{[N.Z.newSearchInProgress]:!(q||c)})},c?a().createElement(C.H3,{className:N.Z.error},a().createElement(h._H,{id:"SearchPage.searchError"})):null,U?null:a().createElement(C.H5,null,a().createElement(h._H,{id:"SearchPage.invalidDatesFilter"})),a().createElement(k.Z,{className:N.Z.searchListingsPanel,listings:s,pagination:q?n:null,search:(0,P.Qc)(r.search),isMapVariant:!1}))))),a().createElement(S.Z,null))}}H.defaultProps={listings:[],pagination:null,searchListingsError:null,searchParams:{}};const L=(0,n.compose)((0,i.connect)((e=>{const{currentPageResultIds:t,pagination:s,searchInProgress:r,searchListingsError:a,searchParams:i}=e.SearchPage;return{listings:(0,b.gg)(e,t),pagination:s,scrollingDisabled:(0,M.uS)(e),searchInProgress:r,searchListingsError:a,searchParams:i}}),(e=>({onManageDisableScrolling:(t,s)=>e((0,M.R4)(t,s))}))))((e=>{const t=(0,g.mX)(),s=(0,m.a5)(),r=(0,h.YB)(),i=(0,l.useHistory)(),n=(0,l.useLocation)();return a().createElement(H,Object.assign({config:t,routeConfiguration:s,intl:r,history:i,location:n},e))}))}};
//# sourceMappingURL=SearchPageWithGrid.746aeab0.chunk.js.map