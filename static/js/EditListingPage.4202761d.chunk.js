"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[2981],{76072:(e,t,i)=>{i.r(t),i.d(t,{EditListingPageComponent:()=>ci,default:()=>ui});var n=i(72791),a=i(42789),l=i(58272),s=i(47375),r=i(80948),o=i(66319),c=i(21102),d=i(73665),u=i(10314),g=i(25863),p=i(46902),m=i(46378),E=i(81301),y=i(52745),v=i(47656),b=i(41418),h=i.n(b),P=i(6639),_=i(86134),L=i(62887),k=i(53002),f=i(44425),D=i(7285),T=i(52007),C=i.n(T),A=i(53176);const S=i(79696).Z;const N=i(56464).Z;var I=i(81420),x=i(76718),W=i(96974),w=i(10190),F=i(27885),M=i(55269);const U="WeekPicker_root__ZSkPB",H="WeekPicker_label__OGVee",O="WeekPicker_popup__NYAWJ",Z="WeekPicker_isOpen__tf6+k",B=new Date,R=e=>n.createElement(M.l0,Object.assign({},e,{onSubmit:()=>null,render:e=>{const{handleSubmit:t,children:i}=e;return n.createElement(E.l0,{onSubmit:t,tabIndex:"0"},n.createElement("div",null,i))}})),z=e=>t=>{27===t.keyCode&&e(!1)},j=e=>{const[t,i]=(0,n.useState)(!1),[a,l]=(0,n.useState)((0,A.$T)(e.date,e.timeZone)),{rootClassName:s,className:r,label:o,date:c,onDateChange:d,timeZone:u,initialValues:g,...p}=e,m=e=>{l(e)},y=h()(s||U,r),v=h()(O,{[Z]:t});return n.createElement(E.jx,{onOutsideClick:()=>i(!1)},n.createElement("div",{className:y,onKeyDown:z(i)},n.createElement(E.T5,{className:H,onClick:()=>i((e=>!e))},o),n.createElement("div",{className:v},t?n.createElement(R,{initialValues:g},n.createElement(E.zE,Object.assign({name:"dates",minimumNights:6,onChange:e=>{let{startDate:t,endDate:n}=e;d(t),i(!1)},initialVisibleMonth:(0,A.$T)(c,u),onPrevMonthClick:()=>m((0,W.RE)(a,u)),onNextMonthClick:()=>m((0,W._l)(a,u)),navNext:n.createElement(w.Z,{showUntilDate:(0,W.Kg)(u,B),startOfNextRange:(0,W._l)(a,u)}),navPrev:n.createElement(F.Z,{showUntilDate:(0,A.RY)(B,"month",u),startOfPrevRange:(0,W.RE)(a,u)})},p))):null)))},V={titleWrapper:"WeeklyCalendar_titleWrapper__Fjty2",weekPicker:"WeeklyCalendar_weekPicker__NRv+g marketplaceSearchFilterSublabelFontStyles",sectionTitle:"WeeklyCalendar_sectionTitle__ckdbM marketplaceSearchFilterSublabelFontStyles",weekPickerLabel:"WeeklyCalendar_weekPickerLabel__5WGN8 marketplaceSearchFilterSublabelFontStyles",weekRange:"WeeklyCalendar_weekRange__SAdar",rangePart:"WeeklyCalendar_rangePart__vZ5LK",weekPickerIcon:"WeeklyCalendar_weekPickerIcon__jA3Nb",navigation:"WeeklyCalendar_navigation__v0+aW",button:"WeeklyCalendar_button__hibIs",prev:"WeeklyCalendar_prev__SZqD9 WeeklyCalendar_button__hibIs",next:"WeeklyCalendar_next__8XEcD WeeklyCalendar_button__hibIs",grid:"WeeklyCalendar_grid__WoQVz",dateLabelContainer:"WeeklyCalendar_dateLabelContainer__evegH",dateLabel:"WeeklyCalendar_dateLabel__k8anz p",dateAndMonth:"WeeklyCalendar_dateAndMonth__qTPq8 h5",blockedDateLabel:"WeeklyCalendar_blockedDateLabel__HFN1R",info:"WeeklyCalendar_info__fIcxo",planEntries:"WeeklyCalendar_planEntries__wuVuH",exceptionsContainer:"WeeklyCalendar_exceptionsContainer__KMG06",exceptionsTitle:"WeeklyCalendar_exceptionsTitle__k94Q+ marketplaceSmallFontStyles",exceptionsSubtitle:"WeeklyCalendar_exceptionsSubtitle__UbcJe marketplaceTinyFontStyles",timeRange:"WeeklyCalendar_timeRange__FhSKf marketplaceTinyFontStyles",availabilityDot:"WeeklyCalendar_availabilityDot__BSDar",isAvailable:"WeeklyCalendar_isAvailable__BGcPL",planEntry:"WeeklyCalendar_planEntry__hIYUo",deleteIconWrapper:"WeeklyCalendar_deleteIconWrapper__5w8Q6",deleteIcon:"WeeklyCalendar_deleteIcon__+PI3f",deleteButton:"WeeklyCalendar_deleteButton__izPaD",exception:"WeeklyCalendar_exception__m3UsM",date:"WeeklyCalendar_date__u-E9u marketplaceTabNavHorizontalFontStyles",blockedDate:"WeeklyCalendar_blockedDate__W0RYd"},Q=new Date,Y=(e,t,i)=>{const n=(0,A.yy)(e,i);return(0,A.gI)("".concat(n," ").concat(t),i)},G=(e,t,i,n)=>"00:00"!=t||i?Y(e,t,n):(0,A.RY)(e,"day",n,1,"days"),q=e=>{let{dateId:t,hasAvailability:i,timeZone:a}=e;const l=(0,A.Cl)(t,a);return n.createElement("div",{className:h()(V.dateLabelContainer,{[V.blockedDateLabel]:!i})},n.createElement(E.H4,{className:h()(V.dateLabel)},n.createElement(r.Ji,{value:l,weekday:"long",timeZone:a}),n.createElement("br",null),n.createElement("span",{className:V.dateAndMonth},n.createElement(r.Ji,{value:l,month:"long",day:"numeric",timeZone:a}))))},K=e=>{let{date:t,entry:i,useFullDays:a,isDaily:l,timeZone:s,intl:o,...c}=e;const u=i.seats>0?n.createElement(r._H,{id:"EditListingAvailabilityPanel.WeeklyCalendar.available"}):n.createElement(r._H,{id:"EditListingAvailabilityPanel.WeeklyCalendar.notAvailable"});return n.createElement("div",Object.assign({className:V.planEntry},c),n.createElement("div",{className:h()(V.availabilityDot,{[V.isAvailable]:i.seats>0})}),a?u:n.createElement(E.tn,{className:V.timeRange,startDate:Y(t,i.startTime,s),endDate:G(t,i.endTime,l,s),dateType:a?d.FJ:d.E2,timeZone:s}))},X=e=>{let{exception:t,useFullDays:i,isDaily:a,timeZone:l,onDeleteAvailabilityException:s}=e;const r=new Date(t.attributes.end.getTime()-1),o=a?r:t.attributes.end;return n.createElement("div",{className:V.exception},n.createElement("div",{className:h()(V.availabilityDot,{[V.isAvailable]:t.attributes.seats>0})}),n.createElement(E.tn,{className:V.timeRange,startDate:t.attributes.start,endDate:o,dateType:i?d.FJ:d.E2,timeZone:l}),n.createElement("button",{className:V.deleteButton,onClick:()=>s({id:t.id})},n.createElement("span",{className:V.deleteIconWrapper},n.createElement(E.Fz,{rootClassName:V.deleteIcon}))))},J=e=>{let{availableExceptions:t,useFullDays:i,isDaily:a,timeZone:l,onDeleteAvailabilityException:s}=e;return t.length>0?n.createElement(n.Fragment,null,n.createElement(E.X6,{as:"h6",rootClassName:V.exceptionsSubtitle},n.createElement(r._H,{id:"EditListingAvailabilityPanel.WeeklyCalendar.available"})),t.map((e=>n.createElement(X,{key:e.id.uuid,exception:e,timeZone:l,useFullDays:i,isDaily:a,onDeleteAvailabilityException:s})))):null},$=e=>{let{blockingExceptions:t,useFullDays:i,isDaily:a,timeZone:l,onDeleteAvailabilityException:s}=e;return t.length>0?n.createElement(n.Fragment,null,n.createElement(E.X6,{as:"h6",rootClassName:V.exceptionsSubtitle},n.createElement(r._H,{id:"EditListingAvailabilityPanel.WeeklyCalendar.notAvailable"})),t.map((e=>n.createElement(X,{key:e.id.uuid,exception:e,timeZone:l,useFullDays:i,isDaily:a,onDeleteAvailabilityException:s})))):null},ee=e=>{var t,i;const a=(0,r.YB)(),{availabilityData:l,hasAvailability:s,isDaily:o,useFullDays:c,onDeleteAvailabilityException:d,fetchExceptionsInProgress:u,fetchExceptionsError:g,timeZone:p}=e,m=(null===l||void 0===l||null===(t=l.planEntries)||void 0===t?void 0:t.length)>0,y=(null===l||void 0===l||null===(i=l.exceptions)||void 0===i?void 0:i.length)>0,v=l.exceptions.filter((e=>e.attributes.seats>0)),b=l.exceptions.filter((e=>0===e.attributes.seats)),P=(0,A.Cl)(null===l||void 0===l?void 0:l.id,p);return n.createElement("div",{className:h()(V.date,{[V.blockedDate]:!s})},n.createElement("div",{className:V.info},m?n.createElement("div",{className:V.planEntries},l.planEntries.map(((e,t)=>n.createElement(K,{key:"entry".concat(t),date:P,entry:e,timeZone:p,isDaily:o,useFullDays:c,intl:a})))):null,y||g?n.createElement("div",{className:V.exceptionsContainer},n.createElement(E.X6,{as:"h5",rootClassName:V.exceptionsTitle,title:"Exceptions overwrite weekly schedule"},n.createElement(r._H,{id:"EditListingAvailabilityPanel.WeeklyCalendar.exceptions"})),u?n.createElement(E.vM,null):g?n.createElement(r._H,{id:"EditListingAvailabilityPanel.WeeklyCalendar.fetchExceptionsError"}):n.createElement(n.Fragment,null,n.createElement(J,{availableExceptions:v,useFullDays:c,isDaily:o,timeZone:p,onDeleteAvailabilityException:d}),n.createElement($,{blockingExceptions:b,useFullDays:c,isDaily:o,timeZone:p,onDeleteAvailabilityException:d}))):null))},te=e=>{let{currentWeek:t,endOfCurrentWeek:i,timeZone:a,intl:l}=e;const s={year:"numeric",month:"short",day:"numeric",timeZone:a},r=l.formatDateTimeRange(t,i,s);return r.length>30?r.split("\u2013").map(((e,t)=>n.createElement("span",{key:"weekspan".concat(t),className:V.rangePart},e,0==t?" ".concat("\u2013"," "):null))):n.createElement("span",{className:V.rangePart},r)},ie=e=>{const[t,i]=(0,n.useState)((e=>{let{locationSearch:t,timeZone:i,firstDayOfWeek:n}=e;const a=null!==t&&void 0!==t&&t.d?(0,A.Cl)(t.d,i):new Date;return(0,A.IS)(a,i,n)})({...e,timeZone:e.availabilityPlan.timezone})),a=(0,r.YB)(),{className:l,rootClassName:s,headerClassName:o,listingId:c,availabilityPlan:d,availabilityExceptions:u,weeklyExceptionQueries:g,isDaily:p,useFullDays:m,onDeleteAvailabilityException:y,onFetchExceptions:v,params:b,firstDayOfWeek:P,routeConfiguration:_,history:L}=e,f=d.timezone,D=(0,W.Kg)(f,new Date),T=(0,A.IS)(Q,f,P),C=(0,A.RY)(t,"day",f,6,"days"),S=(0,A.RY)(t,"day",f,7,"days"),N=(0,x.sg)(t,S,d,u),M=(0,A.yy)(t,f),{fetchExceptionsInProgress:U,fetchExceptionsError:H}=g[M]||{};(0,n.useEffect)((()=>{if(!(0,A.mh)(t,T,D,"day",f)){i(T);const e=(0,k.EW)("EditListingPage",_,b,{});L.replace(e)}}),[t]),(0,n.useEffect)((()=>{if(I.default.dev&&I.default.verbose&&!1===U){const e=(e,t,i,n)=>{const l={hour:"numeric",minute:"numeric",timeZone:n},s=a.formatDate(e,l),r=a.formatDate(t,l),o=i?"\u2705":"\ud83d\udeab";console.log("          ",o,s," - ",r)};console.log("\n\n%cDaily availability ranges:","font-weight: bold;"),Object.keys(N).forEach((t=>{var i,n,l;const s=a.formatDate(null===(i=N[t])||void 0===i||null===(n=i.ranges)||void 0===n||null===(l=n[0])||void 0===l?void 0:l.start,{weekday:"long"});console.log("\n".concat(t," ").concat(s)),N[t].ranges.map((t=>{e(t.start,t.end,t.seats>0,f)}))}))}}),[t,U]);const O=Object.keys(N),Z={currentWeek:t,setCurrentWeek:i,weeklyExceptionQueries:g,listingId:c,timeZone:f,onFetchExceptions:v,firstDayOfWeek:P},B=(0,W.QN)(Z),R=h()(s||V.root,l);return n.createElement("section",{className:R},n.createElement("header",{className:o},n.createElement("div",{className:V.titleWrapper},n.createElement(E.X6,{as:"h2",className:V.sectionTitle},n.createElement(r._H,{id:"EditListingAvailabilityPanel.WeeklyCalendar.scheduleTitle"})),n.createElement(j,{className:V.weekPicker,label:n.createElement("div",{className:V.weekPickerLabel},n.createElement("span",{className:V.weekRange},n.createElement(te,{currentWeek:t,endOfCurrentWeek:C,timeZone:f,intl:a})),n.createElement("span",{className:V.weekPickerIcon},n.createElement(E.JT,{size:"small",direction:"down"}))),initialValues:{dates:{startDate:t,endDate:C}},firstDayOfWeek:P,date:(0,A.XZ)(t),onDateChange:e=>{const t=(0,A.IS)(e,f,P);i(t);const n=(0,k.EW)("EditListingPage",_,b,{d:(0,A.yy)(t)});L.replace(n)},startDateOffset:e=>(0,A.I4)(e,f,P),endDateOffset:e=>(0,A.ux)(e,f,P),onFocusChange:e=>{let{focused:t}=e;return setWeekPickerFocused(t)},isOutsideRange:e=>!(0,A.mh)(e,T,D,"day",f),timeZone:f})),n.createElement("div",{className:V.navigation},n.createElement(F.Z,{className:V.prev,onClick:()=>B(W.XD),showUntilDate:T,startOfPrevRange:(0,W.XD)(t,f,P),size:"big"}),n.createElement(w.Z,{className:V.next,onClick:()=>B(W.PW),showUntilDate:(0,W.Kg)(f,Q),startOfNextRange:(0,W.PW)(t,f,P),size:"big"}))),n.createElement("div",{className:V.grid},O.reduce(((e,t)=>{const i=N[t],a=i.hasAvailability;return e.push(n.createElement(q,{key:"label_".concat(null===i||void 0===i?void 0:i.id),dateId:null===i||void 0===i?void 0:i.id,hasAvailability:a,timeZone:f})),e.push(n.createElement(ee,{key:t,availabilityData:i,hasAvailability:a,onDeleteAvailabilityException:y,isDaily:p,useFullDays:m,timeZone:f,fetchExceptionsInProgress:U,fetchExceptionsError:H})),e}),[])))};ie.defaultProps={rootClassName:null,className:null,headerClassName:null,locationSearch:null,availabilityExceptions:[],firstDayOfWeek:0};const ne=ie,ae="EditListingAvailabilityPanel_root__FcrAt",le="EditListingAvailabilityPanel_sectionHeader__sxUD-",se="EditListingAvailabilityPanel_planInfo__HnaDL",re="EditListingAvailabilityPanel_section__-LQKz",oe="EditListingAvailabilityPanel_editPlanButton__0Mwhr",ce="EditListingAvailabilityPanel_addExceptionButton__HYYI9 h4",de="EditListingAvailabilityPanel_goToNextTabButton__zu6Z9",ue="EditListingAvailabilityPanel_modalContainer__dlvoN marketplaceModalBaseStyles",ge="EditListingAvailabilityPanel_error__pZEtQ",pe=["sun","mon","tue","wed","thu","fri","sat"],me=()=>"undefined"!==typeof window?(0,A.f)():"Etc/UTC",Ee=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[];return e.reduce(((e,i)=>{const{startTime:n,endTime:a,dayOfWeek:l}=i,s=e[l]||[];return t=t.includes(l)?t:[...t,l],{...e,[l]:[...s,{startTime:n,endTime:"00:00"===a?"24:00":a}],activePlanDays:t}}),{})},ye=e=>pe.reduce(((t,i)=>{const n=(e[i]||[]).map((e=>{const{startTime:t,endTime:n}=e;return t&&n?{dayOfWeek:i,seats:1,startTime:t,endTime:"24:00"===n?"00:00":n}:null}));return t.concat(n.filter((e=>!!e)))}),[]),ve=e=>{var t;const{className:i,rootClassName:a,params:l,locationSearch:s,listing:o,monthlyExceptionQueries:c,weeklyExceptionQueries:u,allExceptions:g,onAddAvailabilityException:p,onDeleteAvailabilityException:m,disabled:y,ready:v,onFetchExceptions:b,onSubmit:P,onManageDisableScrolling:_,onNextTab:L,submitButtonText:k,updateInProgress:f,errors:T,config:C,routeConfiguration:I,history:x}=e,[W,w]=(0,n.useState)(!1),[F,M]=(0,n.useState)(!1),[U,H]=(0,n.useState)(null),O=C.localization.firstDayOfWeek,Z=h()(a||ae,i),B=null===o||void 0===o?void 0:o.attributes,R=null===B||void 0===B||null===(t=B.publicData)||void 0===t?void 0:t.unitType,z=(0,D.j8)(R),j=!(null===B||void 0===B||!B.availabilityPlan),V=(null===o||void 0===o?void 0:o.id)&&(null===B||void 0===B?void 0:B.state)!==d.WM,Q={type:"availability-plan/time",timezone:me(),entries:[]},Y=(null===B||void 0===B?void 0:B.availabilityPlan)||Q,G=U||(e=>{const{timezone:t,entries:i}=e||{};return{timezone:t||me(),...Ee(i)}})(Y),q=g;return n.createElement("main",{className:Z},n.createElement(E.H3,{as:"h1"},V?n.createElement(r._H,{id:"EditListingAvailabilityPanel.title",values:{listingTitle:n.createElement(E.tB,{listing:o}),lineBreak:n.createElement("br",null)}}):n.createElement(r._H,{id:"EditListingAvailabilityPanel.createListingTitle",values:{lineBreak:n.createElement("br",null)}})),n.createElement("div",{className:se},j?null:n.createElement("p",null,n.createElement(r._H,{id:"EditListingAvailabilityPanel.availabilityPlanInfo"})),n.createElement(E.T5,{className:oe,onClick:()=>w(!0)},j?n.createElement(r._H,{id:"EditListingAvailabilityPanel.editAvailabilityPlan"}):n.createElement(r._H,{id:"EditListingAvailabilityPanel.setAvailabilityPlan"}))),j?n.createElement(n.Fragment,null,n.createElement(ne,{className:re,headerClassName:le,listingId:o.id,availabilityPlan:Y,availabilityExceptions:q,weeklyExceptionQueries:u,isDaily:R===D.x4,useFullDays:z,onDeleteAvailabilityException:m,onFetchExceptions:b,params:l,locationSearch:s,firstDayOfWeek:O,routeConfiguration:I,history:x}),n.createElement("section",{className:re},n.createElement(E.T5,{className:ce,onClick:()=>M(!0),disabled:y||!j,ready:v},n.createElement(r._H,{id:"EditListingAvailabilityPanel.addException"})))):null,T.showListingsError?n.createElement("p",{className:ge},n.createElement(r._H,{id:"EditListingAvailabilityPanel.showListingFailed"})):null,V?null:n.createElement(E.zx,{className:de,onClick:L,disabled:!j},k),_&&W?n.createElement(E.u_,{id:"EditAvailabilityPlan",isOpen:W,onClose:()=>w(!1),onManageDisableScrolling:_,containerClassName:ue,usePortal:!0},n.createElement(S,{formId:"EditListingAvailabilityPlanForm",listingTitle:null===B||void 0===B?void 0:B.title,availabilityPlan:Y,weekdays:(K=pe,X=O,0===X?K:K.slice(X).concat(K.slice(0,X))),useFullDays:z,onSubmit:e=>(H(e),P((e=>({availabilityPlan:{type:"availability-plan/time",timezone:e.timezone,entries:ye(e)}}))(e)).then((()=>{w(!1)})).catch((e=>{}))),initialValues:G,inProgress:f,fetchErrors:T})):null,_&&F?n.createElement(E.u_,{id:"EditAvailabilityExceptions",isOpen:F,onClose:()=>M(!1),onManageDisableScrolling:_,containerClassName:ue,usePortal:!0},n.createElement(N,{formId:"EditListingAvailabilityExceptionForm",listingId:o.id,allExceptions:g,monthlyExceptionQueries:c,fetchErrors:T,onFetchExceptions:b,onSubmit:e=>{const{availability:t,exceptionStartTime:i,exceptionEndTime:n,exceptionRange:a}=e,l="available"===t?1:0,s=z?{start:null===a||void 0===a?void 0:a.startDate,end:null===a||void 0===a?void 0:a.endDate}:{start:(0,A.Ft)(i),end:(0,A.Ft)(n)},r={listingId:o.id,seats:l,...s};return p(r).then((()=>{M(!1)})).catch((e=>{}))},timeZone:Y.timezone,isDaily:R===D.x4,updateInProgress:f,useFullDays:z})):null);var K,X};ve.defaultProps={className:null,rootClassName:null,listing:null,monthlyExceptionQueries:null,weeklyExceptionQueries:null,allExceptions:[]};const be=ve,he=e=>{const{invalidExistingListingType:t,noListingTypesSet:i,marketplaceName:a}=e;return t?n.createElement("div",null,n.createElement(E.H2,null,n.createElement(r._H,{id:"EditListingDetailsPanel.invalidListingTypeSetTitle"})),n.createElement("p",null,n.createElement(r._H,{id:"EditListingDetailsPanel.invalidListingTypeSetDescription",values:{marketplaceName:a}}))):i?n.createElement("div",null,n.createElement(E.H2,null,n.createElement(r._H,{id:"EditListingDetailsPanel.noListingTypeSetTitle"})),n.createElement("p",null,n.createElement(r._H,{id:"EditListingDetailsPanel.noListingTypeSetDescription"}))):null};var Pe=i(59414);const _e="EditListingDetailsPanel_root__n+H4T",Le="EditListingDetailsPanel_form__3jMRF",ke=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{listingType:n,transactionProcessAlias:a,unitType:l}=t;if(n&&a&&l)return{listingType:n,transactionProcessAlias:a,unitType:l};if(1===e.length){const{listingType:t,label:n,transactionType:a}=e[0],{alias:l,unitType:s}=a;return{listingType:t,transactionProcessAlias:l,unitType:s,...i?{label:n||t}:{}}}return{}},fe=(e,t,i,n)=>n.reduce(((n,a)=>{const{key:l,includeForListingTypes:s,scope:r="public",schemaType:o}=a||{},c="".concat("public"===r?"pub_":"priv_").concat(l),u=d.Mj.includes(o),g=r===t,p=null==s||s.includes(i);if(u&&g&&p){const t=e[c]||null;return{...n,[l]:t}}return u&&g&&!p?{...n,[l]:null}:n}),{}),De=(e,t,i,n)=>n.reduce(((n,a)=>{const{key:l,includeForListingTypes:s,scope:r="public",schemaType:o}=a||{},c="".concat("public"===r?"pub_":"priv_").concat(l),u=d.Mj.includes(o),g=r===t,p=null==s||s.includes(i);if(u&&g&&p){const t=e[l]||null;return{...n,[c]:t}}return n}),{}),Te=e=>{const{className:t,rootClassName:i,listing:a,disabled:l,ready:s,onSubmit:o,onListingTypeChange:c,submitButtonText:u,panelUpdated:g,updateInProgress:p,errors:m,config:y}=e,v=h()(i||_e,t),{publicData:b,state:P}=(null===a||void 0===a?void 0:a.attributes)||{},_=y.listing.listingTypes,L=y.listing.listingFields,{hasExistingListingType:k,existingListingTypeInfo:f}=(e=>{const{listingType:t,transactionProcessAlias:i,unitType:n}=e;return{hasExistingListingType:!!t&&!!i&&!!n,existingListingTypeInfo:{listingType:t,transactionProcessAlias:i,unitType:n}}})(b),T=k&&!!_.find((e=>{var t;const i=e.listingType===f.listingType,n=(null===(t=e.transactionType)||void 0===t?void 0:t.unitType)===f.unitType;return i&&n})),C=((e,t,i,n)=>{var a;const{description:l,title:s,publicData:r,privateData:o}=(null===e||void 0===e||null===(a=e.listing)||void 0===a?void 0:a.attributes)||{},{listingType:c}=r;return{title:s,description:l,...ke(i,t),...De(r,"public",c,n),...De(o,"private",c,n)}})(e,f,_,L),A=0===(null===_||void 0===_?void 0:_.length),S=(null===_||void 0===_?void 0:_.length)>0&&(!k||T),N=(null===a||void 0===a?void 0:a.id)&&P!==d.WM;return n.createElement("div",{className:v},n.createElement(E.H3,{as:"h1"},N?n.createElement(r._H,{id:"EditListingDetailsPanel.title",values:{listingTitle:n.createElement(E.tB,{listing:a}),lineBreak:n.createElement("br",null)}}):n.createElement(r._H,{id:"EditListingDetailsPanel.createListingTitle",values:{lineBreak:n.createElement("br",null)}})),S?n.createElement(Pe.Z,{className:Le,initialValues:C,saveActionMsg:u,onSubmit:e=>{const{title:t,description:i,listingType:n,transactionProcessAlias:a,unitType:l,...s}=e,r={title:t.trim(),description:i,publicData:{listingType:n,transactionProcessAlias:a,unitType:l,...fe(s,"public",n,L)},privateData:fe(s,"private",n,L),...(c=a,(0,D.Ll)(c)?{}:{availabilityPlan:{type:"availability-plan/time",timezone:"Etc/UTC",entries:[]}})};var c;o(r)},selectableListingTypes:_.map((e=>ke([e],{},!0))),hasExistingListingType:k,onListingTypeChange:c,listingFieldsConfig:L,marketplaceCurrency:y.currency,disabled:l,ready:s,updated:g,updateInProgress:p,fetchErrors:m,autoFocus:!0}):n.createElement(he,{marketplaceName:y.marketplaceName,noListingTypesSet:A,invalidExistingListingType:!T}))};Te.defaultProps={className:null,rootClassName:null,errors:null,listing:null};const Ce=Te;var Ae=i(47975);const Se="EditListingDeliveryPanel_root__6QYfp",Ne="EditListingDeliveryPanel_form__k7M+0",Ie="EditListingDeliveryPanel_priceCurrencyInvalid__Lt1Hw",{Money:xe}=o.types,We=e=>{var t,i,n;const{listing:a,listingTypes:l,marketplaceCurrency:s}=e,{geolocation:r,publicData:o,price:c}=(null===a||void 0===a?void 0:a.attributes)||{},d=null===a||void 0===a||null===(t=a.attributes)||void 0===t||null===(i=t.publicData)||void 0===i?void 0:i.listingType,u=l.find((e=>e.listingType===d)),g=(0,L.vA)(u),p=(0,L.r6)(u),m=g&&p,E=(null===o||void 0===o||null===(n=o.location)||void 0===n?void 0:n.address)&&r,y=(null===o||void 0===o?void 0:o.location)||{},{address:v,building:b}=y,{shippingEnabled:h,pickupEnabled:P,shippingPriceInSubunitsOneItem:_,shippingPriceInSubunitsAdditionalItems:k}=o,f=[];(h||!m&&g)&&f.push("shipping"),(P||!m&&p)&&f.push("pickup");const D=(null===c||void 0===c?void 0:c.currency)||s;return{building:b,location:E?{search:v,selectedPlace:{address:v,origin:r}}:{search:void 0,selectedPlace:void 0},deliveryOptions:f,shippingPriceInSubunitsOneItem:null!=_?new xe(_,D):null,shippingPriceInSubunitsAdditionalItems:null!=k?new xe(k,D):null}},we=e=>{var t,i,a,l;const[s,o]=(0,n.useState)({initialValues:We(e)}),{className:c,rootClassName:u,listing:g,listingTypes:p,marketplaceCurrency:m,disabled:y,ready:v,onSubmit:b,submitButtonText:P,panelUpdated:_,updateInProgress:L,errors:k}=e,f=h()(u||Se,c),D=(null===g||void 0===g?void 0:g.id)&&(null===g||void 0===g?void 0:g.attributes.state)!==d.WM,T=(null===g||void 0===g||null===(t=g.attributes)||void 0===t||null===(i=t.price)||void 0===i?void 0:i.currency)===m,C=null===g||void 0===g||null===(a=g.attributes)||void 0===a||null===(l=a.publicData)||void 0===l?void 0:l.listingType,A=p.find((e=>e.listingType===C)),S=A.stockType===d.p9;return n.createElement("div",{className:f},n.createElement(E.H3,{as:"h1"},D?n.createElement(r._H,{id:"EditListingDeliveryPanel.title",values:{listingTitle:n.createElement(E.tB,{listing:g}),lineBreak:n.createElement("br",null)}}):n.createElement(r._H,{id:"EditListingDeliveryPanel.createListingTitle",values:{lineBreak:n.createElement("br",null)}})),T?n.createElement(Ae.Z,{className:Ne,initialValues:s.initialValues,onSubmit:e=>{var t,i;const{building:n="",location:a,shippingPriceInSubunitsOneItem:l,shippingPriceInSubunitsAdditionalItems:s,deliveryOptions:r}=e,c=r.includes("shipping"),d=r.includes("pickup"),u=(null===a||void 0===a||null===(t=a.selectedPlace)||void 0===t?void 0:t.address)||null,g=(null===a||void 0===a||null===(i=a.selectedPlace)||void 0===i?void 0:i.origin)||null,p={geolocation:g,publicData:{pickupEnabled:d,...d&&u?{location:{address:u,building:n}}:{},shippingEnabled:c,...c&&null!=l?{shippingPriceInSubunitsOneItem:l.amount,shippingPriceInSubunitsAdditionalItems:null===s||void 0===s?void 0:s.amount}:{}}};o({initialValues:{building:n,location:{search:u,selectedPlace:{address:u,origin:g}},shippingPriceInSubunitsOneItem:l,shippingPriceInSubunitsAdditionalItems:s,deliveryOptions:r}}),b(p)},listingTypeConfig:A,marketplaceCurrency:m,hasStockInUse:S,saveActionMsg:P,disabled:y,ready:v,updated:_,updateInProgress:L,fetchErrors:k,autoFocus:!0}):n.createElement("div",{className:Ie},n.createElement(r._H,{id:"EditListingPricingPanel.listingPriceCurrencyInvalid"})))};we.defaultProps={className:null,rootClassName:null,listing:null};const Fe=we;var Me=i(33855);const Ue="EditListingLocationPanel_root__qnU3d",He="EditListingLocationPanel_form__OlMB6",Oe=e=>{var t;const{listing:i}=e,{geolocation:n,publicData:a}=(null===i||void 0===i?void 0:i.attributes)||{},l=(null===a||void 0===a||null===(t=a.location)||void 0===t?void 0:t.address)&&n,s=(null===a||void 0===a?void 0:a.location)||{},{address:r,building:o}=s;return{building:o,location:l?{search:r,selectedPlace:{address:r,origin:n}}:null}},Ze=e=>{const[t,i]=(0,n.useState)({initialValues:Oe(e)}),{className:a,rootClassName:l,listing:s,disabled:o,ready:c,onSubmit:u,submitButtonText:g,panelUpdated:p,updateInProgress:m,errors:y}=e,v=h()(l||Ue,a),b=(null===s||void 0===s?void 0:s.id)&&(null===s||void 0===s?void 0:s.attributes.state)!==d.WM;return n.createElement("div",{className:v},n.createElement(E.H3,{as:"h1"},b?n.createElement(r._H,{id:"EditListingLocationPanel.title",values:{listingTitle:n.createElement(E.tB,{listing:s}),lineBreak:n.createElement("br",null)}}):n.createElement(r._H,{id:"EditListingLocationPanel.createListingTitle",values:{lineBreak:n.createElement("br",null)}})),n.createElement(Me.Z,{className:He,initialValues:t.initialValues,onSubmit:e=>{const{building:t="",location:n}=e,{selectedPlace:{address:a,origin:l}}=n,s={geolocation:l,publicData:{location:{address:a,building:t}}};i({initialValues:{building:t,location:{search:a,selectedPlace:{address:a,origin:l}}}}),u(s)},saveActionMsg:g,disabled:o,ready:c,updated:p,updateInProgress:m,fetchErrors:y,autoFocus:!0}))},{func:Be,object:Re,string:ze,bool:je}=C();Ze.defaultProps={className:null,rootClassName:null,listing:null};const Ve=Ze;var Qe=i(81004);const Ye="EditListingPhotosPanel_root__neabH",Ge="EditListingPhotosPanel_form__+Kc5b",qe=e=>{const{images:t}=e;return{images:t}},Ke=e=>{var t;const{className:i,rootClassName:a,errors:l,disabled:s,ready:o,listing:c,onImageUpload:u,submitButtonText:g,panelUpdated:p,updateInProgress:m,onSubmit:y,onRemoveImage:v,listingImageConfig:b}=e,P=a||Ye,_=h()(P,i),L=(null===c||void 0===c?void 0:c.id)&&(null===c||void 0===c||null===(t=c.attributes)||void 0===t?void 0:t.state)!==d.WM;return n.createElement("div",{className:_},n.createElement(E.H3,{as:"h1"},L?n.createElement(r._H,{id:"EditListingPhotosPanel.title",values:{listingTitle:n.createElement(E.tB,{listing:c}),lineBreak:n.createElement("br",null)}}):n.createElement(r._H,{id:"EditListingPhotosPanel.createListingTitle",values:{lineBreak:n.createElement("br",null)}})),n.createElement(Qe.ZP,{className:Ge,disabled:s,ready:o,fetchErrors:l,initialValues:qe(e),onImageUpload:u,onSubmit:e=>{const{addImage:t,...i}=e;y(i)},onRemoveImage:v,saveActionMsg:g,updated:p,updateInProgress:m,listingImageConfig:b}))};Ke.defaultProps={className:null,rootClassName:null,errors:null,images:[],listing:null};const Xe=Ke;var Je=i(22448);const $e="EditListingPricingPanel_root__Jph8a",et="EditListingPricingPanel_form__EC0mp",tt="EditListingPricingPanel_priceCurrencyInvalid__+5vFI",{Money:it}=o.types,nt=e=>{var t,i,a;const{className:l,rootClassName:s,listing:o,marketplaceCurrency:c,listingMinimumPriceSubUnits:u,disabled:g,ready:p,onSubmit:m,submitButtonText:y,panelUpdated:v,updateInProgress:b,errors:P}=e,_=h()(s||$e,l),L=(e=>{const{listing:t}=e,{price:i}=(null===t||void 0===t?void 0:t.attributes)||{};return{price:i}})(e),k=(null===o||void 0===o?void 0:o.id)&&(null===o||void 0===o||null===(t=o.attributes)||void 0===t?void 0:t.state)!==d.WM,f=c&&L.price instanceof it?L.price.currency===c:!!c,D=null===o||void 0===o||null===(i=o.attributes)||void 0===i||null===(a=i.publicData)||void 0===a?void 0:a.unitType;return n.createElement("div",{className:_},n.createElement(E.H3,{as:"h1"},k?n.createElement(r._H,{id:"EditListingPricingPanel.title",values:{listingTitle:n.createElement(E.tB,{listing:o}),lineBreak:n.createElement("br",null)}}):n.createElement(r._H,{id:"EditListingPricingPanel.createListingTitle",values:{lineBreak:n.createElement("br",null)}})),f?n.createElement(Je.Z,{className:et,initialValues:L,onSubmit:e=>{const{price:t}=e;m({price:t})},marketplaceCurrency:c,unitType:D,listingMinimumPriceSubUnits:u,saveActionMsg:y,disabled:g,ready:p,updated:v,updateInProgress:b,fetchErrors:P}):n.createElement("div",{className:tt},n.createElement(r._H,{id:"EditListingPricingPanel.listingPriceCurrencyInvalid",values:{marketplaceCurrency:c}})))},{func:at,object:lt,string:st,bool:rt}=C();nt.defaultProps={className:null,rootClassName:null,listing:null};const ot=nt;var ct=i(37335);const dt="EditListingPricingAndStockPanel_root__uNhR5",ut="EditListingPricingAndStockPanel_form__QtEH2",gt="EditListingPricingAndStockPanel_priceCurrencyInvalid__tjzZ1",{Money:pt}=o.types,mt=1e15,Et=(e,t)=>{const i=e.listingType;return t.find((e=>e.listingType===i))},yt=e=>{var t,i,n,a;const{listing:l,listingTypes:s}=e,r=(null===l||void 0===l?void 0:l.id)&&(null===l||void 0===l||null===(t=l.attributes)||void 0===t?void 0:t.state)!==d.WM,o=null===l||void 0===l||null===(i=l.attributes)||void 0===i?void 0:i.price,c=null===l||void 0===l?void 0:l.currentStock,u=null===l||void 0===l||null===(n=l.attributes)||void 0===n?void 0:n.publicData,g=Et(u,s),p=d.Gw.includes(null===g||void 0===g?void 0:g.stockType),m=null===c||void 0===c||null===(a=c.attributes)||void 0===a?void 0:a.quantity;return{price:o,stock:null!=m?m:r?0:p?mt:1,stockTypeInfinity:[]}},vt=e=>{var t,i,a;const[l,s]=(0,n.useState)({initialValues:yt(e)}),{className:o,rootClassName:c,listing:u,marketplaceCurrency:g,listingMinimumPriceSubUnits:p,listingTypes:m,disabled:y,ready:v,onSubmit:b,submitButtonText:P,panelUpdated:_,updateInProgress:L,errors:k}=e,f=h()(c||dt,o),D=l.initialValues,T=null===u||void 0===u||null===(t=u.attributes)||void 0===t?void 0:t.publicData,C=T.unitType,A=Et(T,m),S=d.Gw.includes(null===A||void 0===A?void 0:A.stockType),N=(null===u||void 0===u?void 0:u.id)&&(null===u||void 0===u||null===(i=u.attributes)||void 0===i?void 0:i.state)!==d.WM,I=g&&D.price instanceof pt?(null===(a=D.price)||void 0===a?void 0:a.currency)===g:!!g;return n.createElement("div",{className:f},n.createElement(E.H3,{as:"h1"},N?n.createElement(r._H,{id:"EditListingPricingAndStockPanel.title",values:{listingTitle:n.createElement(E.tB,{listing:u}),lineBreak:n.createElement("br",null)}}):n.createElement(r._H,{id:"EditListingPricingAndStockPanel.createListingTitle",values:{lineBreak:n.createElement("br",null)}})),I?n.createElement(ct.Z,{className:ut,initialValues:D,onSubmit:e=>{var t,i,n;const{price:a,stock:l,stockTypeInfinity:r}=e,o="infinity"===(null===r||void 0===r?void 0:r[0]),c=null==(null===u||void 0===u||null===(t=u.currentStock)||void 0===t||null===(i=t.attributes)||void 0===i?void 0:i.quantity),d=l&&l!==D.stock,g=c?null:D.stock,p=S&&(c||o)?{stockUpdate:{oldTotal:g,newTotal:mt}}:c||d?{stockUpdate:{oldTotal:g,newTotal:l}}:{},m={price:a,...p};s({initialValues:{price:a,stock:(null===p||void 0===p||null===(n=p.stockUpdate)||void 0===n?void 0:n.newTotal)||l,stockTypeInfinity:r}}),b(m)},listingMinimumPriceSubUnits:p,marketplaceCurrency:g,listingType:A,unitType:C,saveActionMsg:P,disabled:y,ready:v,updated:_,updateInProgress:L,fetchErrors:k}):n.createElement("div",{className:gt},n.createElement(r._H,{id:"EditListingPricingAndStockPanel.listingPriceCurrencyInvalid",values:{marketplaceCurrency:g}})))},{func:bt,object:ht,string:Pt,bool:_t}=C();vt.defaultProps={className:null,rootClassName:null,listing:null};const Lt=vt,kt="EditListingWizardTab_panel__91kEt",ft="details",Dt="pricing",Tt="pricing-and-stock",Ct="delivery",At="location",St="availability",Nt="photos",It=(e,t,i,n,a,l)=>{const s=e.uuid,r={...t,type:c.Ms,id:s};if(t.type===c.wS){const e=(0,k.EW)("EditListingPage",l,r,{});a.replace(e)}const o=((e,t,i)=>{const n=i.findIndex((e=>e===t))+1;return{...e,tab:n<i.length?i[n]:i[i.length-1]}})(r,i,n),d=(0,k.EW)("EditListingPage",l,o,{});a.push(d)},xt=e=>{const{tab:t,marketplaceTabs:i,params:a,locationSearch:l,errors:s,fetchInProgress:r,newListingPublished:o,handleCreateFlowTabScrolling:d,handlePublishListing:g,history:p,images:m,listing:E,weeklyExceptionQueries:y,monthlyExceptionQueries:v,allExceptions:b,onFetchExceptions:h,onAddAvailabilityException:P,onDeleteAvailabilityException:_,onUpdateListing:L,onCreateListingDraft:k,onImageUpload:f,onManageDisableScrolling:D,onListingTypeChange:T,onRemoveImage:C,updatedTab:A,updateInProgress:S,tabSubmitButtonText:N,config:I,routeConfiguration:x}=e,{type:W}=a,w=W===c.wS,F=W===c.Ms,M=w||F,U=(0,u.Me)(E),H=(e,t)=>{const n=w?(e,t)=>k(t,I):(e,t)=>L(e,t,I),l=w?t:{...t,id:U.id};return n(e,l).then((t=>{if(M&&e!==St){const n=t.data.data.id;((e,t)=>{e!==i[i.length-1]?(d(!1),It(t,a,e,i,p,x)):g(t)})(e,n)}})).catch((e=>{}))},O=e=>({className:kt,errors:s,listing:E,panelUpdated:A===e,params:a,locationSearch:l,updateInProgress:S,ready:o,disabled:r,submitButtonText:N,listingTypes:I.listing.listingTypes,onManageDisableScrolling:D,onSubmit:t=>H(e,t)});switch(t){case ft:return n.createElement(Ce,Object.assign({},O(ft),{onListingTypeChange:T,config:I}));case Tt:return n.createElement(Lt,Object.assign({},O(Tt),{marketplaceCurrency:I.currency,listingMinimumPriceSubUnits:I.listingMinimumPriceSubUnits}));case Dt:return n.createElement(ot,Object.assign({},O(Dt),{marketplaceCurrency:I.currency,listingMinimumPriceSubUnits:I.listingMinimumPriceSubUnits}));case Ct:return n.createElement(Fe,Object.assign({},O(Ct),{marketplaceCurrency:I.currency}));case At:return n.createElement(Ve,O(At));case St:return n.createElement(be,Object.assign({allExceptions:b,weeklyExceptionQueries:y,monthlyExceptionQueries:v,onFetchExceptions:h,onAddAvailabilityException:P,onDeleteAvailabilityException:_,onNextTab:()=>It(E.id,a,t,i,p,x),config:I,history:p,routeConfiguration:x},O(St)));case Nt:return n.createElement(Xe,Object.assign({},O(Nt),{listingImageConfig:I.layout.listingImage,images:m,onImageUpload:f,onRemoveImage:C}));default:return null}};xt.defaultProps={listing:null,updatedTab:null};const{array:Wt,bool:wt,func:Ft,object:Mt,oneOf:Ut,shape:Ht,string:Ot}=C(),Zt=xt;var Bt=i(35250);const Rt=[ft],zt=[ft,Tt,Ct,Nt],jt=[ft,At,Dt,St,Nt],Vt=[ft,At,Dt,Nt],Qt="success",Yt="failure",Gt=(e,t)=>t.length>0?e.filter((e=>!t.includes(e))):e,qt=(e,t,i)=>{const n=(t,i)=>{const{key:n,includeForListingTypes:a,schemaType:l,enumOptions:s=[],saveConfig:r={}}=t,o=s.map((e=>"".concat(e.option)));if(!!r.isRequired&&(null==a||a.includes(null===e||void 0===e?void 0:e.listingType))){const e=i[n];return l===d.wR?"string"===typeof e&&(c=e,o.includes(c)):l===d.KP?Array.isArray(e)&&e.every((e=>o.includes(e))):l===d.d$?"string"===typeof e:l===d.F5?"number"===typeof e&&Number.isInteger(e):l===d.WW&&(!0===e||!1===e)}var c;return!0};return i.listing.listingFields.reduce(((i,a)=>{const l="private"===a.scope?t:e;return i&&n(a,l)}),!0)},Kt=(e,t,i,n)=>i.reduce(((a,l)=>{var s,r;const o=i.findIndex((e=>e===l))-1,c=o>=0,d=!(null===t||void 0===t||null===(s=t.attributes)||void 0===s||null===(r=s.publicData)||void 0===r||!r.listingType),u=((e,t,i)=>{var n;const{availabilityPlan:a,description:l,geolocation:s,price:r,title:o,publicData:c,privateData:d}=t.attributes,u=t.images,{listingType:g,transactionProcessAlias:p,unitType:m,shippingEnabled:E,pickupEnabled:y}=c||{},v=c&&(E||y);switch(e){case ft:return!!(l&&o&&g&&p&&m&&qt(c,d,i));case Dt:case Tt:return!!r;case Ct:return!!v;case At:return!(!s||null===c||void 0===c||null===(n=c.location)||void 0===n||!n.address);case St:return!!a;case Nt:return u&&u.length>0;default:return!1}})(i[o],t,n);return{...a,[l]:c&&!e?d:!c||!e||u}}),{}),Xt=(e,t,i,n)=>{const a=(0,k.EW)("EditListingStripeOnboardingPage",i,{...n,returnURLType:e},{}),l=t.replace(/\/$/,"");return"".concat(l).concat(a)},Jt=e=>e.attributes.stripeAccountData||null,$t=e=>e&&e.external_accounts.data.length>0?e.external_accounts.data[0].last4:null,ei=(e,t)=>null!=e&&e.requirements&&Array.isArray(e.requirements[t])&&e.requirements[t].length>0,ti=e=>{let{redirectFn:t}=e;return(0,n.useEffect)(t("custom_account_verification"),[]),n.createElement(r._H,{id:"EditListingWizard.redirectingToStripe"})},ii=(e,t,i)=>{var n,a;const l=null===e||void 0===e||null===(n=e.attributes)||void 0===n||null===(a=n.publicData)||void 0===a?void 0:a.listingType,s=i.listing.listingTypes,r=1===(null===s||void 0===s?void 0:s.length);return l?s.find((e=>e.listingType===l)):t?s.find((e=>e.listingType===t.listingType)):r?s[0]:null};class ni extends n.Component{constructor(e){super(e),this.hasScrolledToTab=!1,this.state={draftId:null,showPayoutDetails:!1,selectedListingType:null},this.handleCreateFlowTabScrolling=this.handleCreateFlowTabScrolling.bind(this),this.handlePublishListing=this.handlePublishListing.bind(this),this.handlePayoutModalClose=this.handlePayoutModalClose.bind(this)}componentDidMount(){const{stripeOnboardingReturnURL:e}=this.props;null==e||this.showPayoutDetails||this.setState({showPayoutDetails:!0})}handleCreateFlowTabScrolling(e){this.hasScrolledToTab=e}handlePublishListing(e){var t,i,n;const{onPublishListingDraft:a,currentUser:l,stripeAccount:s,listing:r,config:o}=this.props,c=(null===r||void 0===r||null===(t=r.attributes)||void 0===t||null===(i=t.publicData)||void 0===i?void 0:i.transactionProcessAlias.split("/")[0])===D.N5,d=ii(r,this.state.selectedListingType,o),u=(0,L.jP)(d),g=!(null===l||void 0===l||null===(n=l.stripeAccount)||void 0===n||!n.id),p=g?Jt(s):null,m=s&&(ei(p,"past_due")||ei(p,"currently_due"));c||!u||g&&!m?a(e):this.setState({draftId:e,showPayoutDetails:!0})}handlePayoutModalClose(){this.setState({showPayoutDetails:!1})}render(){var e,t,i,a,l;const{id:s,className:o,rootClassName:d,params:g,listing:p,viewport:m,intl:y,errors:v,fetchInProgress:b,payoutDetailsSaveInProgress:P,payoutDetailsSaved:_,onManageDisableScrolling:k,onPayoutDetailsChange:f,onGetStripeConnectAccountLink:T,getAccountLinkInProgress:C,createStripeAccountError:A,updateStripeAccountError:S,fetchStripeAccountError:N,stripeAccountFetched:I,stripeAccount:x,stripeAccountError:W,stripeAccountLinkError:w,currentUser:F,config:M,routeConfiguration:U,...H}=this.props,O=g.tab,Z=[c.wS,c.Ms].includes(g.type),B=d||Bt.Z.root,R=h()(B,o),z=(0,u.Me)(p),j=(null===(e=z.attributes)||void 0===e||null===(t=e.publicData)||void 0===t?void 0:t.transactionProcessAlias)||(null===(i=this.state.selectedListingType)||void 0===i?void 0:i.transactionProcessAlias),V=M.listing.listingTypes,Q=ii(z,this.state.selectedListingType,M),Y=null===(a=z.attributes)||void 0===a||null===(l=a.publicData)||void 0===l?void 0:l.listingType,G=Y&&!Q,q=!(0,L.ED)(Q),K=j?j.split("/")[0]:1===V.length?V[0].transactionType.process:D.N5,X=Y||this.state.selectedListingType||1===V.length,J=!Z||!G&&X?(0,D.YL)(K)?((e,t)=>{const i=(0,L.FD)(t)?[]:[At];return Gt(e,i)})(jt,Q):(0,D.Oe)(K)?((e,t)=>{const i=!(0,L.r6)(t)&&!(0,L.vA)(t);return Gt(e,i?[Ct]:[])})(zt,Q):((e,t)=>{const i=(0,L.FD)(t)?[]:[At],n=(0,L.ED)(t)?[]:[Dt];return Gt(e,[...i,...n])})(Vt,Q):Rt,$=Kt(Z,z,J,M);if(G&&Z&&O!==J[0])return n.createElement(E.d9,{name:"EditListingPage",params:{...g,tab:J[0]}});if(!G&&!$[O]){const e=J.indexOf(O),t=J.slice(0,e).reverse().find((e=>$[e]));return console.log("You tried to access an EditListingWizard tab (".concat(O,"), which was not yet activated.")),n.createElement(E.d9,{name:"EditListingPage",params:{...g,tab:t}})}const{width:ee}=m,te=ee>0,ie=te&&ee<=1023;if(te&&ee>1023)this.hasScrolledToTab=!0;else if(ie&&!this.hasScrolledToTab){((e,t)=>{const i=document.querySelector("#".concat(e,"_").concat(t));i&&i.scrollIntoView({block:"start",behavior:"smooth"})})(s,O),this.hasScrolledToTab=!0}const ne=e=>({name:"EditListingPage",params:{...g,tab:e}}),ae=C,le=(0,u.j0)(F),se=!!le.id,re=se&&!!x&&!!x.id,oe=M.marketplaceRootURL,{returnURLType:ce,...de}=g,ue=Xt(Qt,oe,U,de),ge=Xt(Yt,oe,U,de),pe=re?x.id:null,me=re?Jt(x):null,Ee=x&&(ei(me,"past_due")||ei(me,"currently_due")),ye=me?me.country:null,ve=(be=T,he={accountId:pe,successURL:ue,failureURL:ge},e=>()=>{be({type:e,...he}).then((e=>{window.location.href=e})).catch((e=>console.error(e)))});var be,he;const Pe=ce===Yt,_e=re&&Ee;return ce===Qt&&re&&!Ee?n.createElement(E.d9,{name:"EditListingPage",params:de}):n.createElement("div",{className:R},n.createElement(E.mQ,{rootClassName:Bt.Z.tabsContainer,navRootClassName:Bt.Z.nav,tabRootClassName:Bt.Z.tab},J.map((e=>{const t=((e,t,i,n,a)=>{const l=i?"".concat(a,"."):"",s=i?"new":"edit";let r=null,o=null;return t===ft?(r="EditListingWizard.tabLabelDetails",o="EditListingWizard.".concat(l).concat(s,".saveDetails")):t===Dt?(r="EditListingWizard.tabLabelPricing",o="EditListingWizard.".concat(l).concat(s,".savePricing")):t===Tt?(r="EditListingWizard.tabLabelPricingAndStock",o="EditListingWizard.".concat(l).concat(s,".savePricingAndStock")):t===Ct?(r="EditListingWizard.tabLabelDelivery",o="EditListingWizard.".concat(l).concat(s,".saveDelivery")):t===At?(r="EditListingWizard.tabLabelLocation",o=n&&i?"EditListingWizard.".concat(l).concat(s,".saveLocationNoPricingTab"):"EditListingWizard.".concat(l).concat(s,".saveLocation")):t===St?(r="EditListingWizard.tabLabelAvailability",o="EditListingWizard.".concat(l).concat(s,".saveAvailability")):t===Nt&&(r="EditListingWizard.tabLabelPhotos",o="EditListingWizard.".concat(l).concat(s,".savePhotos")),{label:e.formatMessage({id:r}),submitButton:e.formatMessage({id:o})}})(y,e,Z,q,K);return n.createElement(Zt,Object.assign({},H,{key:e,tabId:"".concat(s,"_").concat(e),tabLabel:t.label,tabSubmitButtonText:t.submitButton,tabLinkProps:ne(e),selected:O===e,disabled:Z&&!$[e],tab:e,params:g,listing:p,marketplaceTabs:J,errors:v,handleCreateFlowTabScrolling:this.handleCreateFlowTabScrolling,handlePublishListing:this.handlePublishListing,fetchInProgress:b,onListingTypeChange:e=>this.setState({selectedListingType:e}),onManageDisableScrolling:k,config:M,routeConfiguration:U}))}))),n.createElement(E.u_,{id:"EditListingWizard.payoutModal",isOpen:this.state.showPayoutDetails,onClose:this.handlePayoutModalClose,onManageDisableScrolling:k,usePortal:!0},n.createElement("div",{className:Bt.Z.modalPayoutDetailsWrapper},n.createElement(E.X6,{as:"h2",rootClassName:Bt.Z.modalTitle},n.createElement(r._H,{id:"EditListingWizard.payoutModalTitleOneMoreThing"}),n.createElement("br",null),n.createElement(r._H,{id:"EditListingWizard.payoutModalTitlePayoutPreferences"})),se?Pe&&!w?n.createElement("p",{className:Bt.Z.modalMessage},n.createElement(ti,{redirectFn:ve})):n.createElement(n.Fragment,null,n.createElement("p",{className:Bt.Z.modalMessage},n.createElement(r._H,{id:"EditListingWizard.payoutModalInfo"})),n.createElement(E.qW,{disabled:ae,inProgress:P,ready:_,currentUser:le,stripeBankAccountLastDigits:$t(me),savedCountry:ye,submitButtonText:y.formatMessage({id:"StripePayoutPage.submitButtonText"}),stripeAccountError:W,stripeAccountFetched:I,stripeAccountLinkError:w,onChange:f,onSubmit:H.onPayoutDetailsSubmit,onGetStripeConnectAccountLink:ve,stripeConnected:re},re&&!Pe&&_e?n.createElement(E.oy,{type:"verificationNeeded",inProgress:C,onGetStripeConnectAccountLink:ve("custom_account_verification")}):re&&ye&&!Pe?n.createElement(E.oy,{type:"verificationSuccess",inProgress:C,disabled:P,onGetStripeConnectAccountLink:ve("custom_account_update")}):null)):n.createElement(r._H,{id:"StripePayoutPage.loadingData"}))))}}ni.defaultProps={className:null,currentUser:null,rootClassName:null,listing:null,stripeAccount:null,stripeAccountFetched:null,updateInProgress:!1,createStripeAccountError:null,updateStripeAccountError:null,fetchStripeAccountError:null,stripeAccountError:null,stripeAccountLinkError:null};const ai=(0,f.ss)((e=>{const t=(0,P.mX)(),i=(0,_.a5)(),a=(0,r.YB)();return n.createElement(ni,Object.assign({config:t,routeConfiguration:i,intl:a},e))})),li="EditListingPage_mobileTopbar__SbAP0",si="EditListingPage_desktopTopbar__Zii9i",ri="EditListingPage_wizard__t2Smb",{UUID:oi}=o.types,ci=e=>{const{currentUser:t,createStripeAccountError:i,fetchInProgress:a,fetchStripeAccountError:l,getOwnListing:s,getAccountLinkError:r,getAccountLinkInProgress:o,history:g,intl:p,onFetchExceptions:m,onAddAvailabilityException:v,onDeleteAvailabilityException:b,onCreateListingDraft:h,onPublishListingDraft:P,onUpdateListing:_,onImageUpload:L,onRemoveListingImage:k,onManageDisableScrolling:f,onPayoutDetailsSubmit:D,onPayoutDetailsChange:T,onGetStripeConnectAccountLink:C,page:A,params:S,location:N,scrollingDisabled:I,stripeAccountFetched:x,stripeAccount:W,updateStripeAccountError:w}=e,{id:F,type:M,returnURLType:U}=S,H=M===c.wS,O=M===c.Ms,Z=H||O,B=A.submittedListingId||(F?new oi(F):null),R=(0,u.YC)(s(B)),{state:z}=R.attributes,j=z&&z!==d.WM,V=Z&&B&&j,Q=(!U||!(!t||!t.id))&&(H||R.id);if(V){const e=R&&z===d.v7,t=R?(0,c.qi)(R.attributes.title):null,i=e?{name:"ListingPageVariant",params:{id:B.uuid,slug:t,variant:c.l4}}:{name:"ListingPage",params:{id:B.uuid,slug:t}};return n.createElement(E.d9,i)}if(Q){const{createListingDraftError:e=null,publishListingError:s=null,updateListingError:u=null,showListingsError:F=null,uploadImageError:M=null,setStockError:U=null,uploadedImages:H,uploadedImagesOrder:B,removedImageIds:j,addExceptionError:V=null,deleteExceptionError:Q=null}=A,Y={createListingDraftError:e,publishListingError:s,updateListingError:u,showListingsError:F,uploadImageError:M,setStockError:U,createStripeAccountError:i,addExceptionError:V,deleteExceptionError:Q},G=O&&R&&z!==d.WM,q=A.redirectToListing&&!F,K=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const a=e&&e.images?e.images:[],l=i.map((e=>t[e])),s=a.concat(l),r=(e,t)=>{const i=t.imageId||t.id;return!e.imageIds.includes(i)&&!n.includes(i)&&(e.imageEntities.push(t),e.imageIds.push(i)),e};return s.reduce(r,{imageEntities:[],imageIds:[]}).imageEntities}(R,H,B,j),X=Z?p.formatMessage({id:"EditListingPage.titleCreateListing"}):p.formatMessage({id:"EditListingPage.titleEditListing"});return n.createElement(E.T3,{title:X,scrollingDisabled:I},n.createElement(y.Z,{mobileRootClassName:li,desktopClassName:si,mobileClassName:li}),n.createElement(ai,{id:"EditListingWizard",className:ri,params:S,locationSearch:(0,c.Qc)(N.search),disabled:q,errors:Y,fetchInProgress:a,newListingPublished:G,history:g,images:K,listing:R,weeklyExceptionQueries:A.weeklyExceptionQueries,monthlyExceptionQueries:A.monthlyExceptionQueries,allExceptions:A.allExceptions,onFetchExceptions:m,onAddAvailabilityException:v,onDeleteAvailabilityException:b,onUpdateListing:_,onCreateListingDraft:h,onPublishListingDraft:P,onPayoutDetailsChange:T,onPayoutDetailsSubmit:D,onGetStripeConnectAccountLink:C,getAccountLinkInProgress:o,onImageUpload:L,onRemoveImage:k,currentUser:t,onManageDisableScrolling:f,stripeOnboardingReturnURL:S.returnURLType,updatedTab:A.updatedTab,updateInProgress:A.updateInProgress||A.createListingDraftInProgress,payoutDetailsSaveInProgress:A.payoutDetailsSaveInProgress,payoutDetailsSaved:A.payoutDetailsSaved,stripeAccountFetched:x,stripeAccount:W,stripeAccountError:i||w||l,stripeAccountLinkError:r}))}{const e={id:"EditListingPage.loadingListingData"};return n.createElement(E.T3,{title:p.formatMessage(e),scrollingDisabled:I},n.createElement(y.Z,{mobileRootClassName:li,desktopClassName:si,mobileClassName:li}))}};ci.defaultProps={createStripeAccountError:null,fetchStripeAccountError:null,getAccountLinkError:null,getAccountLinkInProgress:null,stripeAccountFetched:null,currentUser:null,stripeAccount:null,currentUserHasOrders:null,listing:null,listingDraft:null,notificationCount:0,sendVerificationEmailError:null};const di=(0,a.qC)(l.EN,(0,s.$j)((e=>{const t=e.EditListingPage,{getAccountLinkInProgress:i,getAccountLinkError:n,createStripeAccountInProgress:a,createStripeAccountError:l,updateStripeAccountError:s,fetchStripeAccountError:r,stripeAccount:o,stripeAccountFetched:c}=e.stripeConnectAccount;return{getAccountLinkInProgress:i,getAccountLinkError:n,createStripeAccountError:l,updateStripeAccountError:s,fetchStripeAccountError:r,stripeAccount:o,stripeAccountFetched:c,currentUser:e.user.currentUser,fetchInProgress:a,getOwnListing:t=>{const i=(0,g.EV)(e,[{id:t,type:"ownListing"}]);return 1===i.length?i[0]:null},page:t,scrollingDisabled:(0,p.uS)(e)}}),(e=>({onFetchExceptions:t=>e((0,v.dX)(t)),onAddAvailabilityException:t=>e((0,v.g0)(t)),onDeleteAvailabilityException:t=>e((0,v.oG)(t)),onUpdateListing:(t,i,n)=>e((0,v.pI)(t,i,n)),onCreateListingDraft:(t,i)=>e((0,v.Tr)(t,i)),onPublishListingDraft:t=>e((0,v.oE)(t)),onImageUpload:(t,i)=>e((0,v.FS)(t,i)),onManageDisableScrolling:(t,i)=>e((0,p.R4)(t,i)),onPayoutDetailsChange:()=>e((0,m.FZ)()),onPayoutDetailsSubmit:(t,i)=>e((0,v.ZK)(t,i)),onGetStripeConnectAccountLink:t=>e((0,m.cU)(t)),onRemoveListingImage:t=>e((0,v.G$)(t))}))),r.XN)(ci),ui=di}}]);
//# sourceMappingURL=EditListingPage.4202761d.chunk.js.map