"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[9651],{20001:(e,t,a)=>{a.r(t),a.d(t,{ContactDetailsPageComponent:()=>H,default:()=>L});var s=a(72791),r=a(52007),n=a.n(r),i=a(42789),o=a(47375),l=a(80948),m=(a(73665),a(10314)),c=a(99895),d=a(46902),E=a(81301),u=a(52745),h=a(67600),C=a(18111),_=a.n(C),g=a(41418),f=a.n(g),p=a(55269),D=a(84480),P=a(35074);const b={root:"ContactDetailsForm_root__Ve4GD",infoText:"ContactDetailsForm_infoText__eENnH textSmall",contactDetailsSection:"ContactDetailsForm_contactDetailsSection__yE1cF",phone:"ContactDetailsForm_phone__TNaT8",confirmChangesSection:"ContactDetailsForm_confirmChangesSection__UKhEe",confirmChangesSectionVisible:"ContactDetailsForm_confirmChangesSectionVisible__FikTj",emailVerified:"ContactDetailsForm_emailVerified__wUmPI ContactDetailsForm_infoText__eENnH textSmall",emailUnverified:"ContactDetailsForm_emailUnverified__6vOx0 ContactDetailsForm_infoText__eENnH textSmall",pendingEmailUnverified:"ContactDetailsForm_pendingEmailUnverified__L8lfp ContactDetailsForm_infoText__eENnH textSmall",checkInbox:"ContactDetailsForm_checkInbox__8-Myk",emailStyle:"ContactDetailsForm_emailStyle__aCL19",helperLink:"ContactDetailsForm_helperLink__L4Gjt a",tooMany:"ContactDetailsForm_tooMany__6Els+",emailSent:"ContactDetailsForm_emailSent__w+Z3P",confirmChangesTitle:"ContactDetailsForm_confirmChangesTitle__qgvt1",confirmChangesInfo:"ContactDetailsForm_confirmChangesInfo__C8aHm",bottomWrapper:"ContactDetailsForm_bottomWrapper__kI5z-",error:"ContactDetailsForm_error__OKJ6s h4"};class N extends s.Component{constructor(e){super(e),this.state={showVerificationEmailSentMessage:!1,showResetPasswordMessage:!1},this.emailSentTimeoutId=null,this.handleResendVerificationEmail=this.handleResendVerificationEmail.bind(this),this.handleResetPassword=this.handleResetPassword.bind(this),this.submittedValues={}}componentWillUnmount(){window.clearTimeout(this.emailSentTimeoutId)}handleResendVerificationEmail(){this.setState({showVerificationEmailSentMessage:!0}),this.props.onResendVerificationEmail().then((()=>{this.emailSentTimeoutId=window.setTimeout((()=>{this.setState({showVerificationEmailSentMessage:!1})}),2e3)}))}handleResetPassword(){this.setState({showResetPasswordMessage:!0});const e=this.props.currentUser.attributes.email;this.props.onResetPassword(e)}render(){return s.createElement(p.l0,Object.assign({},this.props,{render:e=>{const{rootClassName:t,className:a,saveEmailError:r,savePhoneNumberError:n,currentUser:i,formId:o,handleSubmit:c,inProgress:d,intl:u,invalid:h,sendVerificationEmailError:C,sendVerificationEmailInProgress:g,resetPasswordInProgress:p,values:N}=e,{email:F,phoneNumber:w}=N,v=(0,m.j0)(i);if(!v.id)return null;const{email:V,emailVerified:S,pendingEmail:I,profile:T}=v.attributes,H=V!==F,M=u.formatMessage({id:"ContactDetailsForm.emailLabel"}),k=V||"",L=u.formatMessage({id:"ContactDetailsForm.emailRequired"}),R=D.C1(L),x=u.formatMessage({id:"ContactDetailsForm.emailInvalid"}),U=D.gX(x),y=(0,P.rn)(C),A=this.submittedValues.email!==N.email,O=(0,P.$q)(r)?u.formatMessage({id:"ContactDetailsForm.emailTakenError"}):null;let j=null;j=y?s.createElement("span",{className:b.tooMany},s.createElement(l._H,{id:"ContactDetailsForm.tooManyVerificationRequests"})):g||this.state.showVerificationEmailSentMessage?s.createElement("span",{className:b.emailSent},s.createElement(l._H,{id:"ContactDetailsForm.emailSent"})):s.createElement("span",{className:b.helperLink,onClick:this.handleResendVerificationEmail,role:"button"},s.createElement(l._H,{id:"ContactDetailsForm.resendEmailVerificationText"}));let q=null;if(!S||I||H)if(S||I){if(I){const e=s.createElement("span",{className:b.emailStyle},I),t=s.createElement("span",{className:b.checkInbox},s.createElement(l._H,{id:"ContactDetailsForm.pendingEmailCheckInbox",values:{pendingEmail:e}}));q=s.createElement("span",{className:b.pendingEmailUnverified},s.createElement(l._H,{id:"ContactDetailsForm.pendingEmailUnverified",values:{pendingEmailCheckInbox:t,resendEmailMessage:j}}))}}else q=s.createElement("span",{className:b.emailUnverified},s.createElement(l._H,{id:"ContactDetailsForm.emailUnverified",values:{resendEmailMessage:j}}));else q=s.createElement("span",{className:b.emailVerified},s.createElement(l._H,{id:"ContactDetailsForm.emailVerified"}));const K=(T.protectedData||{}).phoneNumber,Z=K!==w&&!("undefined"===typeof K&&""===w),W=u.formatMessage({id:"ContactDetailsForm.phonePlaceholder"}),B=u.formatMessage({id:"ContactDetailsForm.phoneLabel"}),X=u.formatMessage({id:"ContactDetailsForm.passwordLabel"}),z=u.formatMessage({id:"ContactDetailsForm.passwordPlaceholder"}),G=u.formatMessage({id:"ContactDetailsForm.passwordRequired"}),J=D.uL(G),Y=u.formatMessage({id:"ContactDetailsForm.passwordTooShort"},{minLength:D.Z9}),$=D.Ei(Y,D.Z9),Q=H?D.A3(J,$):null,ee=u.formatMessage({id:"ContactDetailsForm.passwordFailed"}),te=this.submittedValues.currentPassword!==N.currentPassword,ae=(0,P.JY)(r)?ee:null,se=f()(b.confirmChangesSection,{[b.confirmChangesSectionVisible]:H}),re=r&&!(O||ae);let ne=null;re&&n?ne=s.createElement("span",{className:b.error},s.createElement(l._H,{id:"ContactDetailsForm.genericFailure"})):re?ne=s.createElement("span",{className:b.error},s.createElement(l._H,{id:"ContactDetailsForm.genericEmailFailure"})):n&&(ne=s.createElement("span",{className:b.error},s.createElement(l._H,{id:"ContactDetailsForm.genericPhoneNumberFailure"})));const ie=s.createElement("span",{className:b.helperLink,onClick:this.handleResetPassword,role:"button"},s.createElement(l._H,{id:"ContactDetailsForm.resetPasswordLinkText"})),oe=s.createElement("span",{className:b.helperLink,onClick:this.handleResetPassword,role:"button"},s.createElement(l._H,{id:"ContactDetailsForm.resendPasswordLinkText"})),le=this.state.showResetPasswordMessage||p?s.createElement(s.Fragment,null,s.createElement(l._H,{id:"ContactDetailsForm.resetPasswordLinkSent",values:{email:s.createElement("span",{className:b.emailStyle},i.attributes.email)}})," ",oe):ie,me=f()(t||b.root,a),ce=Object.keys(this.submittedValues).length>0&&_()(N,this.submittedValues),de=h||ce||d||!(H||Z);return s.createElement(E.l0,{className:me,onSubmit:e=>{this.submittedValues=N,c(e)}},s.createElement("div",{className:b.contactDetailsSection},s.createElement(E.gC,{type:"email",name:"email",id:o?"".concat(o,".email"):"email",label:M,placeholder:k,validate:D.A3(R,U),customErrorText:A?null:O}),q,s.createElement(E.IY,{className:b.phone,name:"phoneNumber",id:o?"".concat(o,".phoneNumber"):"phoneNumber",label:B,placeholder:W})),s.createElement("div",{className:se},s.createElement(E.H4,{as:"h3",className:b.confirmChangesTitle},s.createElement(l._H,{id:"ContactDetailsForm.confirmChangesTitle"})),s.createElement("p",{className:b.confirmChangesInfo},s.createElement(l._H,{id:"ContactDetailsForm.confirmChangesInfo"}),s.createElement("br",null),s.createElement(l._H,{id:"ContactDetailsForm.resetPasswordInfo",values:{resetPasswordLink:le}})),s.createElement(E.gC,{className:b.password,type:"password",name:"currentPassword",id:o?"".concat(o,".currentPassword"):"currentPassword",autoComplete:"current-password",label:X,placeholder:z,validate:Q,customErrorText:te?null:ae})),s.createElement("div",{className:b.bottomWrapper},ne,s.createElement(E.KM,{type:"submit",inProgress:d,ready:ce,disabled:de},s.createElement(l._H,{id:"ContactDetailsForm.saveChanges"}))))}}))}}N.defaultProps={rootClassName:null,className:null,formId:null,saveEmailError:null,savePhoneNumberError:null,inProgress:!1,sendVerificationEmailError:null,sendVerificationEmailInProgress:!1,email:null,phoneNumber:null,resetPasswordInProgress:!1,resetPasswordError:null};const{bool:F,func:w,string:v}=n(),V=(0,i.qC)(l.XN)(N);V.displayName="ContactDetailsForm";const S=V;var I=a(65703);const T={content:"ContactDetailsPage_content__NOhC-",desktopTopbar:"ContactDetailsPage_desktopTopbar__fVtHT",mobileTopbar:"ContactDetailsPage_mobileTopbar__miBEM"},H=e=>{const{saveEmailError:t,savePhoneNumberError:a,saveContactDetailsInProgress:r,currentUser:n,contactDetailsChanged:i,onChange:o,scrollingDisabled:c,sendVerificationEmailInProgress:d,sendVerificationEmailError:C,onResendVerificationEmail:_,onSubmitContactDetails:g,onResetPassword:f,resetPasswordInProgress:p,resetPasswordError:D,intl:P}=e,b=(0,m.j0)(n),N=b.attributes.email||"",F=(b.attributes.profile.protectedData||{}).phoneNumber||"",w=b.id?s.createElement(S,{className:T.form,initialValues:{email:N,phoneNumber:F},saveEmailError:t,savePhoneNumberError:a,currentUser:n,onResendVerificationEmail:_,onResetPassword:f,onSubmit:e=>g({...e,currentEmail:N,currentPhoneNumber:F}),onChange:o,inProgress:r,ready:i,sendVerificationEmailInProgress:d,sendVerificationEmailError:C,resetPasswordInProgress:p,resetPasswordError:D}):null,v=P.formatMessage({id:"ContactDetailsPage.title"});return s.createElement(E.T3,{title:v,scrollingDisabled:c},s.createElement(E.i_,{topbar:s.createElement(s.Fragment,null,s.createElement(u.Z,{currentPage:"ContactDetailsPage",desktopClassName:T.desktopTopbar,mobileClassName:T.mobileTopbar}),s.createElement(E.Tb,{currentPage:"ContactDetailsPage"})),sideNav:null,useAccountSettingsNav:!0,currentPage:"ContactDetailsPage",footer:s.createElement(h.Z,null)},s.createElement("div",{className:T.content},s.createElement(E.H3,{as:"h1"},s.createElement(l._H,{id:"ContactDetailsPage.heading"})),w)))};H.defaultProps={saveEmailError:null,savePhoneNumberError:null,currentUser:null,sendVerificationEmailError:null,resetPasswordInProgress:!1,resetPasswordError:null};const{bool:M,func:k}=n(),L=(0,i.qC)((0,o.$j)((e=>{const{currentUser:t,sendVerificationEmailInProgress:a,sendVerificationEmailError:s}=e.user,{saveEmailError:r,savePhoneNumberError:n,saveContactDetailsInProgress:i,contactDetailsChanged:o,resetPasswordInProgress:l,resetPasswordError:m}=e.ContactDetailsPage;return{saveEmailError:r,savePhoneNumberError:n,saveContactDetailsInProgress:i,currentUser:t,contactDetailsChanged:o,scrollingDisabled:(0,d.uS)(e),sendVerificationEmailInProgress:a,sendVerificationEmailError:s,resetPasswordInProgress:l,resetPasswordError:m}}),(e=>({onChange:()=>e((0,I.de)()),onResendVerificationEmail:()=>e((0,c.zk)()),onSubmitContactDetails:t=>e((0,I.AH)(t)),onResetPassword:t=>e((0,I.c0)(t))}))),l.XN)(H)}}]);
//# sourceMappingURL=ContactDetailsPage.517d2637.chunk.js.map