"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[3326],{38975:(e,t,r)=>{r.d(t,{Z:()=>h});var n=r(72791),i=r(55950),a=r(66319),o=r(80948),l=r(73665),d=r(79908),s=r(7285),c=r(81301),u=r(60949);const{Money:m,UUID:y}=a.types,p=(e,t)=>{const r=e.reduce(((e,t)=>{const r=(0,d.ud)(t.lineTotal);return new i.Z(r).add(e)}),new i.Z(0)),n=e[0]&&e[0].unitPrice?e[0].unitPrice.currency:t;return new m((0,d.aV)(r.toNumber(),(0,d.p_)(n)),n)},v=function(e,t,r){const n={start:e,end:t};return{id:new y("estimated-booking"),type:"booking",attributes:{...n}}},h=e=>{const{breakdownData:t={},lineItems:r,timeZone:i,currency:a,marketplaceName:d,processName:m}=e,{startDate:h,endDate:M}=t;let E=null;try{E=(0,s.Yt)(m)}catch(k){return n.createElement("div",{className:u.Z.error},n.createElement(o._H,{id:"OrderPanel.unknownTransactionProcess"}))}const _=null===r||void 0===r?void 0:r.find((e=>l.Y8.includes(e.code)&&!e.reversal)),O=null===_||void 0===_?void 0:_.code,g=[l.E4,l.mi].includes(O),f=r&&r.length>0,P=!g||h&&M,F=O===l.PC?l.In:l.FJ,b=f&&P?((e,t,r,n,i,a,o,l)=>{const d=null===a||void 0===a?void 0:a.transitions,c=new Date,u=e.filter((e=>e.includeFor.includes("customer"))),m=e.filter((e=>e.includeFor.includes("provider"))),h=p(u,l),M=p(m,l),E=t&&r?{booking:v(t,r,n,i)}:{};return{id:new y("estimated-transaction"),type:"transaction",attributes:{createdAt:c,processName:o,lastTransitionedAt:c,lastTransition:d.REQUEST_PAYMENT,payinTotal:h,payoutTotal:M,lineItems:u,transitions:[{createdAt:c,by:s.AL,transition:d.REQUEST_PAYMENT}]},...E}})(r,h,M,O,i,E,m,a):null;return b?n.createElement(c.J0,{className:u.Z.receipt,userRole:"customer",transaction:b,booking:b.booking,dateType:F,timeZone:i,currency:a,marketplaceName:d}):null}},59461:(e,t,r)=>{r.r(t),r.d(t,{default:()=>F});var n=r(72791),i=r(55269),a=r(80948),o=(r(73665),r(84480)),l=r(7285),d=r(81301),s=r(38975);const c="ProductOrderForm_bookingBreakdownTitle__epmbq",u="ProductOrderForm_totalDivider__x1b-R",m="ProductOrderForm_quantityField__SB1jH",y="ProductOrderForm_deliveryField__hsRoF",p="ProductOrderForm_singleDeliveryMethodLabel__Jm4QI label",v="ProductOrderForm_singleDeliveryMethodSelected__ML6x7",h="ProductOrderForm_breakdownWrapper__Pvcv5",M="ProductOrderForm_submitButton__PvTZR",E="ProductOrderForm_finePrint__LxKZ- marketplaceTinyFontStyles",_="ProductOrderForm_error__1Fy1Z h4",O=e=>{let{quantity:t,deliveryMethod:r,displayDeliveryMethod:n,listingId:i,isOwnListing:a,fetchLineItemsInProgress:o,onFetchTransactionLineItems:l}=e;const d=Number.parseInt(t,10);!("undefined"!==typeof window)||!d||n&&!r||o||l({orderData:{stockReservationQuantity:d,...r?{deliveryMethod:r}:{}},listingId:i,isOwnListing:a})},g=e=>{const{displayDeliveryMethod:t,hasMultipleDeliveryMethods:r,deliveryMethod:i,hasStock:a,formId:l,intl:s}=e,c=t&&i;return a?t&&r?n.createElement(d.Wy,{id:"".concat(l,".deliveryMethod"),className:y,name:"deliveryMethod",label:s.formatMessage({id:"ProductOrderForm.deliveryMethodLabel"}),validate:(0,o.C1)(s.formatMessage({id:"ProductOrderForm.deliveryMethodRequired"}))},n.createElement("option",{disabled:!0,value:""},s.formatMessage({id:"ProductOrderForm.selectDeliveryMethodOption"})),n.createElement("option",{value:"pickup"},s.formatMessage({id:"ProductOrderForm.pickupOption"})),n.createElement("option",{value:"shipping"},s.formatMessage({id:"ProductOrderForm.shippingOption"}))):c?n.createElement("div",{className:y},n.createElement(d.H3,{rootClassName:p},s.formatMessage({id:"ProductOrderForm.deliveryMethodLabel"})),n.createElement("p",{className:v},"shipping"===i?s.formatMessage({id:"ProductOrderForm.shippingOption"}):s.formatMessage({id:"ProductOrderForm.pickupOption"})),n.createElement(d.gC,{id:"".concat(l,".deliveryMethod"),className:y,name:"deliveryMethod",type:"hidden"})):null:null},f=e=>{const[t,r]=(0,n.useState)(!1),{handleSubmit:y,form:p,intl:v,formId:_,currentStock:f,allowOrdersOfMultipleItems:P,hasMultipleDeliveryMethods:F,displayDeliveryMethod:b,listingId:k,isOwnListing:D,onFetchTransactionLineItems:I,onContactUser:N,lineItems:L,fetchLineItemsInProgress:w,fetchLineItemsError:q,price:T,payoutDetailsWarning:S,marketplaceName:H,values:A}=e;(0,n.useEffect)((()=>{r(!0);const{quantity:t,deliveryMethod:n}=A;t&&!e.hasMultipleDeliveryMethods&&O({quantity:t,deliveryMethod:n,displayDeliveryMethod:b,listingId:k,isOwnListing:D,fetchLineItemsInProgress:w,onFetchTransactionLineItems:I})}),[]);const C={},Z=C&&L&&!w&&!q,R="function"===typeof N,B=n.createElement(d.T5,{onClick:e=>{e.preventDefault(),N()}},n.createElement(a._H,{id:"ProductOrderForm.finePrintNoStockLinkText"})),U=v.formatMessage({id:"ProductOrderForm.quantityRequired"}),Q=null!=typeof f&&0===f,Y=f&&f>0,x=1===f,K=Y?[...Array(f>100?100:f).keys()].map((e=>e+1)):[],W=w,J=!Y;return n.createElement(d.l0,{onSubmit:e=>{const{quantity:t,deliveryMethod:r}=A||{};!t||t<1?(e.preventDefault(),p.blur("quantity"),p.focus("quantity")):b&&!r?(e.preventDefault(),p.blur("deliveryMethod"),p.focus("deliveryMethod")):y(e)}},n.createElement(i.lP,{subscription:{values:!0},onChange:e=>{const{quantity:r,deliveryMethod:n}=e.values;t&&O({quantity:r,deliveryMethod:n,listingId:k,isOwnListing:D,fetchLineItemsInProgress:w,onFetchTransactionLineItems:I})}}),Q?null:x||!P?n.createElement(d.gC,{id:"".concat(_,".quantity"),className:m,name:"quantity",type:"hidden",validate:(0,o.DG)(U,1)}):n.createElement(d.Wy,{id:"".concat(_,".quantity"),className:m,name:"quantity",disabled:!Y,label:v.formatMessage({id:"ProductOrderForm.quantityLabel"}),validate:(0,o.DG)(U,1)},n.createElement("option",{disabled:!0,value:""},v.formatMessage({id:"ProductOrderForm.selectQuantityOption"})),K.map((e=>n.createElement("option",{key:e,value:e},v.formatMessage({id:"ProductOrderForm.quantityOption"},{quantity:e}))))),n.createElement(g,{displayDeliveryMethod:b,hasMultipleDeliveryMethods:F,deliveryMethod:null===A||void 0===A?void 0:A.deliveryMethod,hasStock:Y,formId:_,intl:v}),Z?n.createElement("div",{className:h},n.createElement(d.H6,{as:"h3",className:c},n.createElement(a._H,{id:"ProductOrderForm.breakdownTitle"})),n.createElement("hr",{className:u}),n.createElement(s.Z,{breakdownData:C,lineItems:L,currency:T.currency,marketplaceName:H,processName:l.fv})):null,n.createElement("div",{className:M},n.createElement(d.KM,{type:"submit",inProgress:W,disabled:J},Y?n.createElement(a._H,{id:"ProductOrderForm.ctaButton"}):n.createElement(a._H,{id:"ProductOrderForm.ctaButtonNoStock"}))),n.createElement("p",{className:E},S||(Y&&D?n.createElement(a._H,{id:"ProductOrderForm.ownListing"}):Y?n.createElement(a._H,{id:"ProductOrderForm.finePrint"}):R?n.createElement(a._H,{id:"ProductOrderForm.finePrintNoStock",values:{contactSellerLink:B}}):null)))},P=e=>{const t=(0,a.YB)(),{price:r,currentStock:o,pickupEnabled:l,shippingEnabled:d,displayDeliveryMethod:s,allowOrdersOfMultipleItems:c}=e;if(s&&!l&&!d)return n.createElement("p",{className:_},n.createElement(a._H,{id:"ProductOrderForm.noDeliveryMethodSet"}));const u=l&&d,m={...o&&1===o||!c&&o>0?{quantity:"1"}:{},...d&&!l?{deliveryMethod:"shipping"}:!d&&l?{deliveryMethod:"pickup"}:{}};return n.createElement(i.l0,Object.assign({initialValues:m,hasMultipleDeliveryMethods:u,displayDeliveryMethod:s},e,{intl:t,render:f}))};P.defaultProps={rootClassName:null,className:null,price:null,currentStock:null,listingId:null,isOwnListing:!1,pickupEnabled:!1,shippingEnabled:!1,displayDeliveryMethod:!1,lineItems:null,fetchLineItemsError:null};const F=P}}]);
//# sourceMappingURL=ProductOrderForm.d3c8ee52.chunk.js.map