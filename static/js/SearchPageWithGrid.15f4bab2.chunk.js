"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[5756],{90909:(e,t,s)=>{s.r(t),s.d(t,{SearchPageComponent:()=>N,default:()=>O});var a=s(72791),r=s(47375),l=s(42789),i=s(58272),n=s(24242),o=s.n(n),c=s(41418),d=s.n(c),u=s(80948),h=s(6639),g=s(86134),m=s(53002),p=s(21956),y=s(21102),P=(s(73665),s(25863)),b=s(46902),C=s(81301),M=s(52745),E=s(67600),S=s(87419),f=s(79733),v=s(85678),A=s(75876),F=s(97803),Z=s(69407),L=s(58351),k=s(18681);class N extends a.Component{constructor(e){super(e),this.state={isMobileModalOpen:!1,currentQueryParams:(0,S.K3)(e)},this.onOpenMobileModal=this.onOpenMobileModal.bind(this),this.onCloseMobileModal=this.onCloseMobileModal.bind(this),this.resetAll=this.resetAll.bind(this),this.getHandleChangedValueFn=this.getHandleChangedValueFn.bind(this),this.handleSortBy=this.handleSortBy.bind(this)}onOpenMobileModal(){this.setState({isMobileModalOpen:!0})}onCloseMobileModal(){this.setState({isMobileModalOpen:!1})}resetAll(e){const{history:t,routeConfiguration:s,config:a}=this.props,{listingFields:r}=(null===a||void 0===a?void 0:a.listing)||{},{defaultFilters:l}=(null===a||void 0===a?void 0:a.search)||{},i=(0,S.K3)(this.props),n=(0,p.sU)(r,l);this.setState({currentQueryParams:{}});const c=o()(i,n);t.push((0,m.EW)("SearchPage",s,{},c))}getHandleChangedValueFn(e){const{history:t,routeConfiguration:s,config:a}=this.props,{listingFields:r}=(null===a||void 0===a?void 0:a.listing)||{},{defaultFilters:l,sortConfig:i}=(null===a||void 0===a?void 0:a.search)||{},n=(0,S.K3)(this.props);return o=>{this.setState((e=>{const{address:t,bounds:s,keywords:r}=n,l={...n,...e.currentQueryParams},i=(0,p.Sy)(a)?{keywords:r}:{};return{currentQueryParams:{...l,...o,...i,address:t,bounds:s}}}),(()=>{if(e){const e=this.state.currentQueryParams,a=(0,S.zU)(e,r,l,i);t.push((0,m.EW)("SearchPage",s,{},a))}}))}}handleSortBy(e,t){const{history:s,routeConfiguration:a}=this.props,r=(0,S.K3)(this.props),l=t?{...r,[e]:t}:o()(r,e);s.push((0,m.EW)("SearchPage",a,{},l))}handleResetAll(e){this.resetAll(e),e&&e.currentTarget&&e.currentTarget.blur()}render(){var e;const{intl:t,listings:s,location:r,onManageDisableScrolling:l,pagination:i,scrollingDisabled:n,searchInProgress:o,searchListingsError:c,searchParams:h,routeConfiguration:g,config:m}=this.props,{listingFields:P}=(null===m||void 0===m?void 0:m.listing)||{},{defaultFilters:b,sortConfig:N}=(null===m||void 0===m?void 0:m.search)||{},O=null===m||void 0===m||null===(e=m.listing)||void 0===e?void 0:e.listingTypes.map((e=>e.listingType)),_=m.currency,{searchParamsAreInSync:H,urlQueryParams:B,searchParamsInURL:D}=(0,S.uG)(r.search,h,P,b,N,(0,p.QS)(m)),I=(0,S.ZB)(D,P,b,!1),Q=(0,p.Sy)(m),V=Q?b.filter((e=>"keywords"!==e.key)):b,[w,R]=(0,S.Wo)(P,O),W=[...w,...V,...R],U=(0,S.ZB)(I,P,b),K=null==D.dates||null!=D.dates&&D.dates===U.dates,T=Object.keys(U),x=Q?T.filter((e=>"keywords"!==e)).length:T.length,j=!!i&&null!=i.totalItems,q=H&&j?i.totalItems:null!==i&&void 0!==i&&i.paginationUnsupported?s.length:0,G=!o&&H&&!!(j||null!==i&&void 0!==i&&i.paginationUnsupported),z=(0,p._)(N.conflictingFilters,I,P,b),X=e=>{var t;return N.active?a.createElement(F.Z,{sort:I[N.queryParamName],isConflictingFilterActive:!!z,hasConflictingFilters:!!((null===(t=N.conflictingFilters)||void 0===t?void 0:t.length)>0),selectedFilters:U,onSelect:this.handleSortBy,showAsPopup:!0,mode:e,contentPlacementOffset:-14}):null},Y=a.createElement(L.Z,{listingsAreLoaded:G,totalItems:q,location:r,resetAll:this.resetAll}),{title:$,description:J,schema:ee}=(0,S.A6)(s,D||{},t,g,m),te=this.state.isMobileModalOpen?d()(k.Z.topbarBehindModal,k.Z.topbar):k.Z.topbar;return a.createElement(C.T3,{scrollingDisabled:n,description:J,title:$,schema:ee},a.createElement(M.Z,{rootClassName:te,currentPage:"SearchPage",currentSearchParams:B}),a.createElement("div",{className:k.Z.layoutWrapperContainer},a.createElement("aside",{className:k.Z.layoutWrapperFilterColumn,"data-testid":"filterColumnAside"},a.createElement("div",{className:k.Z.filterColumnContent},W.map((e=>a.createElement(f.Z,{key:"SearchFiltersMobile.".concat(e.scope||"built-in",".").concat(e.key),idPrefix:"SearchFiltersMobile",className:k.Z.filter,config:e,marketplaceCurrency:_,urlQueryParams:B,initialValues:(0,S.Sc)(this.props,this.state.currentQueryParams),getHandleChangedValueFn:this.getHandleChangedValueFn,intl:t,liveEdit:!0,showAsPopup:!1,isDesktop:!0}))),a.createElement("button",{className:k.Z.resetAllButton,onClick:e=>this.handleResetAll(e)},a.createElement(u._H,{id:"SearchFiltersMobile.resetAll"})))),a.createElement("div",{className:k.Z.layoutWrapperMain,role:"main"},a.createElement("div",{className:k.Z.searchResultContainer},a.createElement(A.Z,{className:k.Z.searchFiltersMobileList,urlQueryParams:I,sortByComponent:X("mobile"),listingsAreLoaded:G,resultsCount:q,searchInProgress:o,searchListingsError:c,showAsModalMaxWidth:768,onManageDisableScrolling:l,onOpenModal:this.onOpenMobileModal,onCloseModal:this.onCloseMobileModal,resetAll:this.resetAll,selectedFiltersCount:x,isMapVariant:!1,noResultsInfo:Y},W.map((e=>a.createElement(f.Z,{key:"SearchFiltersMobile.".concat(e.scope||"built-in",".").concat(e.key),idPrefix:"SearchFiltersMobile",config:e,marketplaceCurrency:_,urlQueryParams:I,initialValues:(0,S.Sc)(this.props,this.state.currentQueryParams),getHandleChangedValueFn:this.getHandleChangedValueFn,intl:t,liveEdit:!0,showAsPopup:!1})))),a.createElement(v.Z,{className:k.Z.mainPanel,sortByComponent:X("desktop"),isSortByActive:N.active,listingsAreLoaded:G,resultsCount:q,searchInProgress:o,searchListingsError:c,noResultsInfo:Y}),a.createElement("div",{className:d()(k.Z.listingsForGridVariant,{[k.Z.newSearchInProgress]:!(G||c)})},c?a.createElement(C.H3,{className:k.Z.error},a.createElement(u._H,{id:"SearchPage.searchError"})):null,K?null:a.createElement(C.H5,null,a.createElement(u._H,{id:"SearchPage.invalidDatesFilter"})),a.createElement(Z.Z,{className:k.Z.searchListingsPanel,listings:s,pagination:G?i:null,search:(0,y.Qc)(r.search),isMapVariant:!1}))))),a.createElement(E.Z,null))}}N.defaultProps={listings:[],pagination:null,searchListingsError:null,searchParams:{}};const O=(0,l.qC)((0,r.$j)((e=>{const{currentPageResultIds:t,pagination:s,searchInProgress:a,searchListingsError:r,searchParams:l}=e.SearchPage;return{listings:(0,P.gg)(e,t),pagination:s,scrollingDisabled:(0,b.uS)(e),searchInProgress:a,searchListingsError:r,searchParams:l}}),(e=>({onManageDisableScrolling:(t,s)=>e((0,b.R4)(t,s))}))))((e=>{const t=(0,h.mX)(),s=(0,g.a5)(),r=(0,u.YB)(),l=(0,i.k6)(),n=(0,i.TH)();return a.createElement(N,Object.assign({config:t,routeConfiguration:s,intl:r,history:l,location:n},e))}))}}]);
//# sourceMappingURL=SearchPageWithGrid.15f4bab2.chunk.js.map